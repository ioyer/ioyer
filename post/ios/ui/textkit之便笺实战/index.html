<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>TextKitä¹‹ä¾¿ç¬ºå®æˆ˜ - Even - A super concise theme for Hugo</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="iTBoyer" /><meta name="description" content="ä¾¿ç¬ºç»ƒä¹ åŠŸèƒ½ç‚¹: é€šè¿‡å®ç°ä»¥ä¸‹ç‰¹æ•ˆï¼Œç»ƒä¹ å¹¶æŒæ¡å¸ƒå±€ç®¡ç†å™¨ï¼ˆlayout mangerï¼‰ï¼Œæ–‡æœ¬å®¹å™¨ï¼ˆtext containersï¼‰å’Œæ–‡æœ¬å­˜å‚¨å™¨ï¼ˆtext storageï¼‰ç­‰ç”¨æ³•ã€‚ * åŠ¨æ€æ ·å¼ï¼ˆDynamic typeï¼‰
* å‡¸ç‰ˆå°åˆ·æ•ˆæœï¼ˆLetterpress effectsï¼‰
* ç¯ç»•è·¯å¾„ï¼ˆExclusion pathsï¼‰
* åŠ¨æ€æ–‡æœ¬æ ¼å¼åŠå­˜å‚¨ï¼ˆDynamic text formatting and storageï¼‰
è¿™ä¸ªåº”ç”¨ä¸­æˆ‘ä»¬å°†å®ç°å›æµæ–‡æœ¬ï¼Œå­—ä½“å¤§å°çš„åŠ¨æ€å˜æ¢ï¼Œä»¥åŠé—ªå›æ–‡æœ¬ç­‰æ•ˆæœã€‚ æ•ˆæœå›¾:
Appå¼€å§‹è¿è¡Œåè‡ªåŠ¨ç”Ÿæˆä¸€ç»„ä¾¿ç¬ºå®ä¾‹å¹¶åˆ©ç”¨tableViewControlleræ˜¾ç¤ºå‡ºæ¥ã€‚Storyboardså’Œseguesä¼šå°†è¢«é€‰ä¸­çš„å•å…ƒæ ¼æ‰€å¯¹åº”çš„ä¾¿ç¬ºå†…å®¹æ˜¾ç¤ºå‡ºæ¥ä»¥ä¾›ç”¨æˆ·ç¼–è¾‘ã€‚ é¡¹ç›®å¼€å‘åŒ…ï¼šNotepad.zip
åŠ¨æ€æ ·å¼ åŠ¨æ€æ ·å¼ï¼ˆDynamic typeï¼‰æ˜¯iOS 7é‡Œé¢å˜åŒ–æœ€å¤§çš„ç‰¹æ€§ä¹‹ä¸€; å®ƒä½¿å¾—appå¯ä»¥éµä»ç”¨æˆ·é€‰æ‹©çš„å­—ä½“å¤§å°å’Œç²—ç»†ã€‚ é€‰æ‹© é€šç”¨-&amp;gt;æ–‡å­—å¤§å° æˆ– é€šç”¨-&amp;gt;è¾…åŠ©åŠŸèƒ½ æ¥æŸ¥çœ‹appä¸­çš„å­—ä½“è®¾ç½®ã€‚
iOS 7 æ”¯æŒé€šè¿‡ç²—ä½“ã€è®¾ç½®å­—ä½“å¤§å°ç­‰æ–¹å¼æé«˜æ”¯æŒåŠ¨æ€æ–‡æœ¬çš„åº”ç”¨çš„æ˜“è¯»æ€§ã€‚ ä¾‹å¦‚UIFontæ–°å¢çš„ä¸€ä¸ªæ–¹æ³•ï¼š preferredFontForTextStyle ç”¨æ¥æ ¹æ®ç”¨æˆ·å¯¹å­—ä½“å¤§å°çš„è®¾ç½®æ¥è‡ªåŠ¨åˆ¶å®šå­—ä½“æ ·å¼ã€‚
ä¸‹é¢è¡¨æ ¼ä¸­æ˜¯å…­ç§å¯ç”¨å­—ä½“æ ·å¼çš„ç¤ºä¾‹ï¼š
æœ€å·¦è¾¹ä¸€åˆ—æ˜¯æœ€å°å­—ä½“ï¼›ä¸­é—´ä¸€åˆ—æ˜¯æœ€å¤§å­—ä½“ï¼›æœ€å³è¾¹ä¸€åˆ—æ˜¯ç²—ä½“æ•ˆæœã€‚
ä½¿ç”¨ç³»ç»ŸåŠ¨æ€å­—ä½“æ ·å¼ ä½¿ç”¨åŠ¨æ€æ–‡æœ¬ï¼Œæ˜¯é€šè¿‡ç»™æ–‡æœ¬å­—ä½“è®¾ç½®å­—ä½“æ ·å¼styleè€Œä¸æ˜¯æŒ‡å®šå…·ä½“çš„å­—ä½“åç§°å’Œå¤§å°ã€‚è¿™æ ·ï¼Œç³»ç»Ÿä¼šåœ¨è¿è¡Œæ—¶è‡ªåŠ¨æ ¹æ®è¿™ä¸€æ ·å¼ä»¥åŠç”¨æˆ·çš„å­—ä½“å¤§å°è®¾ç½®æ¥é€‰æ‹©ä½¿ç”¨åˆé€‚çš„å­—ä½“ã€‚
preferredFontForTextStyle:æ–¹æ³•è®¾ç½®å­—ä½“æ ·å¼  æ‰“å¼€ NoteEditorViewController.m/swift åœ¨viewDidLoadï¼šæ–¹æ³•å®ç°çš„æœ€åé¢åŠ å…¥ä»¥ä¸‹ä»£ç ï¼š {%codeblock lang:objc%} self.textView.font = [UIFont preferredFontForTextStyle:UIFontTextStyleBody]; {%endcodeblock%} {% codeblock lang:swift %} self.textView.font = UIFont.preferredFont(forTextStyle: .body) {% endcodeblock %} æ‰“å¼€ NotesListViewController.m/swift åœ¨ tableView:cellForRowAtIndexPath: æ–¹æ³•ä¸­å¢åŠ å¦‚ä¸‹ä»£ç : {%codeblock lang:objc%} cell.textLabel.font = [UIFont preferredFontForTextStyle:UIFontTextStyleHeadline]; {%endcodeblock%} {% codeblock lang:swift %} cell.textLabel?.font = UIFont.preferredFont(forTextStyle: .headline) {% endcodeblock %} ä¸Šé¢ä¸¤è¡Œä»£ç éƒ½ç”¨åˆ°äº†æ–°ç‰ˆiOSçš„å­—ä½“æ ·å¼.
&amp;gt; å­—ä½“æ ·å¼ï¼šé€šè¿‡è¯­ä¹‰æ³•å‘½åå­—ä½“ï¼Œä¾‹å¦‚ UIFontTextStyleSubHeadline, å¯ä»¥é¿å…åœ¨ä»£ç é‡Œæ¯ä¸€å¤„éƒ½æŒ‡å®šå…·ä½“çš„å­—ä½“åç§°å’Œæ ·å¼ï¼Œ è€Œä¸”ç¡®ä¿appèƒ½å¯¹ç”¨æˆ·çš„å­—ä½“å¤§å°è®¾ç½®åšå‡ºæ°å½“çš„å›åº”ã€‚  APPå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®  è®¾ç½®ç³»ç»Ÿå­—ä½“ è¿”å›åˆ°é€šç”¨-&amp;gt;æ–‡å­—å¤§å°é‡æ–°ä¿®æ”¹å­—ä½“è®¾ç½®. å†è¿è¡ŒApp, Noteé¡µé¢çš„æ–‡å­—å¤§å°æ˜¯å½“å‰è®¾å®šçš„å­—ä½“å¤§å°ï¼›å‰åæˆªå±å¯¹æ¯”,åˆ†è¾¨ç‡å°äº†ä¸€åŠã€‚
 è®¾ç½®ç³»ç»Ÿå­—ä½“ç”Ÿæ•ˆ å½“æˆ‘ä»¬è¿”å›åˆ°é€šç”¨-&amp;gt;æ–‡å­—å¤§å°é‡æ–°ä¿®æ”¹å­—ä½“è®¾ç½®. å†æ‰“å¼€Noteé¡µé¢, ä¼šå‘ç°appå¹¶æ²¡æœ‰ç«‹å³å¯¹å­—ä½“è®¾ç½®çš„å˜åŒ–åšå‡ºç›¸åº”ååº”ã€‚  ç›‘å¬ç³»ç»Ÿé€šçŸ¥ï¼šå®ç°APPå“åº”ç”¨æˆ·å­—ä½“è®¾ç½® å½“ç”¨æˆ·ä¿®æ”¹äº†ä»–ä»¬çš„å­—ä½“å¤§å°è®¾ç½®ä¹‹åï¼Œè¿™ä¸€æ ·å¼å¯¹åº”çš„å­—ä½“å¹¶ä¸ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œå¿…é¡»é‡æ–°è¯·æ±‚æ‰èƒ½è·å–æ–°çš„å€¼ã€‚ç”¨æˆ·è®¾ç½®å˜åŒ–åï¼ŒpreferredFontForTextStyle:æ–¹æ³•è¿”å›çš„å­—ä½“ä¹Ÿä¼šå˜åŒ–ã€‚ 1. æ·»åŠ ç›‘å¬ç³»ç»Ÿé€šçŸ¥UIContentSizeCategoryDidChangeNotificationé€šçŸ¥APPå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®çš„å˜åŒ– æ‰“å¼€ NoteEditorViewController.m å¹¶åœ¨ viewDidLoad æ–¹æ³•çš„å®ç°çš„æœ€ååŠ å…¥ä»¥ä¸‹ä»£ç ï¼š {%codeblock lang:objc%} [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(preferredContentSizeChanged:) name:UIContentSizeCategoryDidChangeNotification object:nil]; {%endcodeblock%} {%codeblock lang:swift%} //å­—ä½“å˜åŒ–é€šçŸ¥:è°ƒç”¨preferredContentSizeChanged:æ–¹æ³• NotificationCenter.default.addObserver(self, selector: #selector(NoteEditorViewController.preferredContentSizeChanged(:)), name: NSNotification.Name.UIContentSizeCategoryDidChange, object: nil) {%endcodeblock%} 2. æ·»åŠ ç³»ç»Ÿé€šçŸ¥å“åº”äº‹ä»¶ æ”¶åˆ°ç”¨äºæŒ‡å®šæœ¬ç±»æ¥æ”¶å­—ä½“è®¾å®šå˜åŒ–çš„é€šçŸ¥åï¼Œè°ƒç”¨preferredContentSizeChanged:æ–¹æ³• åœ¨NoteEditorViewController.mä¸­viewDidLoadæ–¹æ³•ä¹‹åç´§æ¥ç€æ·»åŠ ä»¥ä¸‹æ–¹æ³•ï¼š {%codeblock lang:objc%} - (void)preferredContentSizeChanged:(NSNotification *)notification { self.textView.font = [UIFont preferredFontForTextStyle:UIFontTextStyleBody]; } {%endcodeblock%} {%codeblock lang:swift %} //å­—ä½“å˜åŒ–é€šçŸ¥æ—¶è°ƒç”¨ func preferredContentSizeChanged( notification:NSNotification) { self.textView.font = UIFont.preferredFont(forTextStyle: .body) } {%endcodeblock%} è¿™ä¸€æ–¹æ³•ä½œç”¨æ˜¯æ ¹æ®æ–°çš„å­—ä½“è®¾ç½®æ¥è®¾å®štextViewä¸­çš„å­—ä½“ã€‚
Buildå¹¶è¿è¡Œappï¼Œä¿®æ”¹å­—ä½“å¤§å°è®¾ç½®ï¼ŒNoteé¡µé¢å°±å¯ä»¥å³æ—¶æ›´æ–°å­—ä½“å¤§å°äº†ã€‚
" /><meta name="keywords" content="Hugo, swift, org-mode" />






<meta name="generator" content="Hugo 0.56.3 with even 4.0.0" />


<link rel="canonical" href="https://huos3203.github.io/post/ios/ui/textkit%E4%B9%8B%E4%BE%BF%E7%AC%BA%E5%AE%9E%E6%88%98/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<link href="/dist/even.c2a46f00.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="TextKitä¹‹ä¾¿ç¬ºå®æˆ˜" />
<meta property="og:description" content="ä¾¿ç¬ºç»ƒä¹ åŠŸèƒ½ç‚¹:

é€šè¿‡å®ç°ä»¥ä¸‹ç‰¹æ•ˆï¼Œç»ƒä¹ å¹¶æŒæ¡å¸ƒå±€ç®¡ç†å™¨ï¼ˆlayout mangerï¼‰ï¼Œæ–‡æœ¬å®¹å™¨ï¼ˆtext containersï¼‰å’Œæ–‡æœ¬å­˜å‚¨å™¨ï¼ˆtext storageï¼‰ç­‰ç”¨æ³•ã€‚
  * åŠ¨æ€æ ·å¼ï¼ˆDynamic typeï¼‰
  * å‡¸ç‰ˆå°åˆ·æ•ˆæœï¼ˆLetterpress effectsï¼‰
  * ç¯ç»•è·¯å¾„ï¼ˆExclusion pathsï¼‰
  * åŠ¨æ€æ–‡æœ¬æ ¼å¼åŠå­˜å‚¨ï¼ˆDynamic text formatting and storageï¼‰

è¿™ä¸ªåº”ç”¨ä¸­æˆ‘ä»¬å°†å®ç°å›æµæ–‡æœ¬ï¼Œå­—ä½“å¤§å°çš„åŠ¨æ€å˜æ¢ï¼Œä»¥åŠé—ªå›æ–‡æœ¬ç­‰æ•ˆæœã€‚
æ•ˆæœå›¾:

Appå¼€å§‹è¿è¡Œåè‡ªåŠ¨ç”Ÿæˆä¸€ç»„ä¾¿ç¬ºå®ä¾‹å¹¶åˆ©ç”¨tableViewControlleræ˜¾ç¤ºå‡ºæ¥ã€‚Storyboardså’Œseguesä¼šå°†è¢«é€‰ä¸­çš„å•å…ƒæ ¼æ‰€å¯¹åº”çš„ä¾¿ç¬ºå†…å®¹æ˜¾ç¤ºå‡ºæ¥ä»¥ä¾›ç”¨æˆ·ç¼–è¾‘ã€‚
é¡¹ç›®å¼€å‘åŒ…ï¼šNotepad.zip

åŠ¨æ€æ ·å¼

åŠ¨æ€æ ·å¼ï¼ˆDynamic typeï¼‰æ˜¯iOS 7é‡Œé¢å˜åŒ–æœ€å¤§çš„ç‰¹æ€§ä¹‹ä¸€; å®ƒä½¿å¾—appå¯ä»¥éµä»ç”¨æˆ·é€‰æ‹©çš„å­—ä½“å¤§å°å’Œç²—ç»†ã€‚
é€‰æ‹© é€šç”¨-&gt;æ–‡å­—å¤§å° æˆ– é€šç”¨-&gt;è¾…åŠ©åŠŸèƒ½ æ¥æŸ¥çœ‹appä¸­çš„å­—ä½“è®¾ç½®ã€‚


iOS 7 æ”¯æŒé€šè¿‡ç²—ä½“ã€è®¾ç½®å­—ä½“å¤§å°ç­‰æ–¹å¼æé«˜æ”¯æŒåŠ¨æ€æ–‡æœ¬çš„åº”ç”¨çš„æ˜“è¯»æ€§ã€‚
ä¾‹å¦‚UIFontæ–°å¢çš„ä¸€ä¸ªæ–¹æ³•ï¼š preferredFontForTextStyle ç”¨æ¥æ ¹æ®ç”¨æˆ·å¯¹å­—ä½“å¤§å°çš„è®¾ç½®æ¥è‡ªåŠ¨åˆ¶å®šå­—ä½“æ ·å¼ã€‚
ä¸‹é¢è¡¨æ ¼ä¸­æ˜¯å…­ç§å¯ç”¨å­—ä½“æ ·å¼çš„ç¤ºä¾‹ï¼š

æœ€å·¦è¾¹ä¸€åˆ—æ˜¯æœ€å°å­—ä½“ï¼›ä¸­é—´ä¸€åˆ—æ˜¯æœ€å¤§å­—ä½“ï¼›æœ€å³è¾¹ä¸€åˆ—æ˜¯ç²—ä½“æ•ˆæœã€‚

ä½¿ç”¨ç³»ç»ŸåŠ¨æ€å­—ä½“æ ·å¼

ä½¿ç”¨åŠ¨æ€æ–‡æœ¬ï¼Œæ˜¯é€šè¿‡ç»™æ–‡æœ¬å­—ä½“è®¾ç½®å­—ä½“æ ·å¼styleè€Œä¸æ˜¯æŒ‡å®šå…·ä½“çš„å­—ä½“åç§°å’Œå¤§å°ã€‚è¿™æ ·ï¼Œç³»ç»Ÿä¼šåœ¨è¿è¡Œæ—¶è‡ªåŠ¨æ ¹æ®è¿™ä¸€æ ·å¼ä»¥åŠç”¨æˆ·çš„å­—ä½“å¤§å°è®¾ç½®æ¥é€‰æ‹©ä½¿ç”¨åˆé€‚çš„å­—ä½“ã€‚

preferredFontForTextStyle:æ–¹æ³•è®¾ç½®å­—ä½“æ ·å¼


æ‰“å¼€ NoteEditorViewController.m/swift åœ¨viewDidLoadï¼šæ–¹æ³•å®ç°çš„æœ€åé¢åŠ å…¥ä»¥ä¸‹ä»£ç ï¼š
{%codeblock lang:objc%}
self.textView.font = [UIFont preferredFontForTextStyle:UIFontTextStyleBody];
{%endcodeblock%}
{% codeblock  lang:swift %}
self.textView.font = UIFont.preferredFont(forTextStyle: .body)
{% endcodeblock %}
æ‰“å¼€ NotesListViewController.m/swift åœ¨ tableView:cellForRowAtIndexPath: æ–¹æ³•ä¸­å¢åŠ å¦‚ä¸‹ä»£ç :
{%codeblock lang:objc%}
cell.textLabel.font = [UIFont preferredFontForTextStyle:UIFontTextStyleHeadline];
{%endcodeblock%}
{% codeblock  lang:swift %}
cell.textLabel?.font = UIFont.preferredFont(forTextStyle: .headline)
{% endcodeblock %}
ä¸Šé¢ä¸¤è¡Œä»£ç éƒ½ç”¨åˆ°äº†æ–°ç‰ˆiOSçš„å­—ä½“æ ·å¼.
&gt; å­—ä½“æ ·å¼ï¼šé€šè¿‡è¯­ä¹‰æ³•å‘½åå­—ä½“ï¼Œä¾‹å¦‚ UIFontTextStyleSubHeadline, å¯ä»¥é¿å…åœ¨ä»£ç é‡Œæ¯ä¸€å¤„éƒ½æŒ‡å®šå…·ä½“çš„å­—ä½“åç§°å’Œæ ·å¼ï¼Œ è€Œä¸”ç¡®ä¿appèƒ½å¯¹ç”¨æˆ·çš„å­—ä½“å¤§å°è®¾ç½®åšå‡ºæ°å½“çš„å›åº”ã€‚


APPå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®


è®¾ç½®ç³»ç»Ÿå­—ä½“
è¿”å›åˆ°é€šç”¨-&gt;æ–‡å­—å¤§å°é‡æ–°ä¿®æ”¹å­—ä½“è®¾ç½®.
å†è¿è¡ŒApp, Noteé¡µé¢çš„æ–‡å­—å¤§å°æ˜¯å½“å‰è®¾å®šçš„å­—ä½“å¤§å°ï¼›å‰åæˆªå±å¯¹æ¯”,åˆ†è¾¨ç‡å°äº†ä¸€åŠã€‚

è®¾ç½®ç³»ç»Ÿå­—ä½“ç”Ÿæ•ˆ
å½“æˆ‘ä»¬è¿”å›åˆ°é€šç”¨-&gt;æ–‡å­—å¤§å°é‡æ–°ä¿®æ”¹å­—ä½“è®¾ç½®. å†æ‰“å¼€Noteé¡µé¢, ä¼šå‘ç°appå¹¶æ²¡æœ‰ç«‹å³å¯¹å­—ä½“è®¾ç½®çš„å˜åŒ–åšå‡ºç›¸åº”ååº”ã€‚


ç›‘å¬ç³»ç»Ÿé€šçŸ¥ï¼šå®ç°APPå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®

å½“ç”¨æˆ·ä¿®æ”¹äº†ä»–ä»¬çš„å­—ä½“å¤§å°è®¾ç½®ä¹‹åï¼Œè¿™ä¸€æ ·å¼å¯¹åº”çš„å­—ä½“å¹¶ä¸ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œå¿…é¡»é‡æ–°è¯·æ±‚æ‰èƒ½è·å–æ–°çš„å€¼ã€‚ç”¨æˆ·è®¾ç½®å˜åŒ–åï¼ŒpreferredFontForTextStyle:æ–¹æ³•è¿”å›çš„å­—ä½“ä¹Ÿä¼šå˜åŒ–ã€‚
1. æ·»åŠ ç›‘å¬ç³»ç»Ÿé€šçŸ¥UIContentSizeCategoryDidChangeNotificationé€šçŸ¥APPå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®çš„å˜åŒ–
æ‰“å¼€ NoteEditorViewController.m å¹¶åœ¨ viewDidLoad æ–¹æ³•çš„å®ç°çš„æœ€ååŠ å…¥ä»¥ä¸‹ä»£ç ï¼š
{%codeblock lang:objc%}
[[NSNotificationCenter defaultCenter]
                              addObserver:self
                                 selector:@selector(preferredContentSizeChanged:)
                                     name:UIContentSizeCategoryDidChangeNotification
                                   object:nil];
{%endcodeblock%}
{%codeblock lang:swift%}
//å­—ä½“å˜åŒ–é€šçŸ¥:è°ƒç”¨preferredContentSizeChanged:æ–¹æ³•
NotificationCenter.default.addObserver(self, selector: #selector(NoteEditorViewController.preferredContentSizeChanged(:)), name: NSNotification.Name.UIContentSizeCategoryDidChange, object: nil)
{%endcodeblock%}
2. æ·»åŠ ç³»ç»Ÿé€šçŸ¥å“åº”äº‹ä»¶
æ”¶åˆ°ç”¨äºæŒ‡å®šæœ¬ç±»æ¥æ”¶å­—ä½“è®¾å®šå˜åŒ–çš„é€šçŸ¥åï¼Œè°ƒç”¨preferredContentSizeChanged:æ–¹æ³•
åœ¨NoteEditorViewController.mä¸­viewDidLoadæ–¹æ³•ä¹‹åç´§æ¥ç€æ·»åŠ ä»¥ä¸‹æ–¹æ³•ï¼š
{%codeblock lang:objc%}
- (void)preferredContentSizeChanged:(NSNotification *)notification
{
    self.textView.font = [UIFont preferredFontForTextStyle:UIFontTextStyleBody];
}
{%endcodeblock%}
{%codeblock lang:swift %}
//å­—ä½“å˜åŒ–é€šçŸ¥æ—¶è°ƒç”¨
func preferredContentSizeChanged( notification:NSNotification)
{
    self.textView.font = UIFont.preferredFont(forTextStyle: .body)
}
{%endcodeblock%}
è¿™ä¸€æ–¹æ³•ä½œç”¨æ˜¯æ ¹æ®æ–°çš„å­—ä½“è®¾ç½®æ¥è®¾å®štextViewä¸­çš„å­—ä½“ã€‚
Buildå¹¶è¿è¡Œappï¼Œä¿®æ”¹å­—ä½“å¤§å°è®¾ç½®ï¼ŒNoteé¡µé¢å°±å¯ä»¥å³æ—¶æ›´æ–°å­—ä½“å¤§å°äº†ã€‚" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://huos3203.github.io/post/ios/ui/textkit%E4%B9%8B%E4%BE%BF%E7%AC%BA%E5%AE%9E%E6%88%98/" />
<meta property="article:published_time" content="2014-07-03T17:29:00+08:00" />
<meta property="article:modified_time" content="2019-08-08T17:46:02+08:00" />
<meta itemprop="name" content="TextKitä¹‹ä¾¿ç¬ºå®æˆ˜">
<meta itemprop="description" content="ä¾¿ç¬ºç»ƒä¹ åŠŸèƒ½ç‚¹:

é€šè¿‡å®ç°ä»¥ä¸‹ç‰¹æ•ˆï¼Œç»ƒä¹ å¹¶æŒæ¡å¸ƒå±€ç®¡ç†å™¨ï¼ˆlayout mangerï¼‰ï¼Œæ–‡æœ¬å®¹å™¨ï¼ˆtext containersï¼‰å’Œæ–‡æœ¬å­˜å‚¨å™¨ï¼ˆtext storageï¼‰ç­‰ç”¨æ³•ã€‚
  * åŠ¨æ€æ ·å¼ï¼ˆDynamic typeï¼‰
  * å‡¸ç‰ˆå°åˆ·æ•ˆæœï¼ˆLetterpress effectsï¼‰
  * ç¯ç»•è·¯å¾„ï¼ˆExclusion pathsï¼‰
  * åŠ¨æ€æ–‡æœ¬æ ¼å¼åŠå­˜å‚¨ï¼ˆDynamic text formatting and storageï¼‰

è¿™ä¸ªåº”ç”¨ä¸­æˆ‘ä»¬å°†å®ç°å›æµæ–‡æœ¬ï¼Œå­—ä½“å¤§å°çš„åŠ¨æ€å˜æ¢ï¼Œä»¥åŠé—ªå›æ–‡æœ¬ç­‰æ•ˆæœã€‚
æ•ˆæœå›¾:

Appå¼€å§‹è¿è¡Œåè‡ªåŠ¨ç”Ÿæˆä¸€ç»„ä¾¿ç¬ºå®ä¾‹å¹¶åˆ©ç”¨tableViewControlleræ˜¾ç¤ºå‡ºæ¥ã€‚Storyboardså’Œseguesä¼šå°†è¢«é€‰ä¸­çš„å•å…ƒæ ¼æ‰€å¯¹åº”çš„ä¾¿ç¬ºå†…å®¹æ˜¾ç¤ºå‡ºæ¥ä»¥ä¾›ç”¨æˆ·ç¼–è¾‘ã€‚
é¡¹ç›®å¼€å‘åŒ…ï¼šNotepad.zip

åŠ¨æ€æ ·å¼

åŠ¨æ€æ ·å¼ï¼ˆDynamic typeï¼‰æ˜¯iOS 7é‡Œé¢å˜åŒ–æœ€å¤§çš„ç‰¹æ€§ä¹‹ä¸€; å®ƒä½¿å¾—appå¯ä»¥éµä»ç”¨æˆ·é€‰æ‹©çš„å­—ä½“å¤§å°å’Œç²—ç»†ã€‚
é€‰æ‹© é€šç”¨-&gt;æ–‡å­—å¤§å° æˆ– é€šç”¨-&gt;è¾…åŠ©åŠŸèƒ½ æ¥æŸ¥çœ‹appä¸­çš„å­—ä½“è®¾ç½®ã€‚


iOS 7 æ”¯æŒé€šè¿‡ç²—ä½“ã€è®¾ç½®å­—ä½“å¤§å°ç­‰æ–¹å¼æé«˜æ”¯æŒåŠ¨æ€æ–‡æœ¬çš„åº”ç”¨çš„æ˜“è¯»æ€§ã€‚
ä¾‹å¦‚UIFontæ–°å¢çš„ä¸€ä¸ªæ–¹æ³•ï¼š preferredFontForTextStyle ç”¨æ¥æ ¹æ®ç”¨æˆ·å¯¹å­—ä½“å¤§å°çš„è®¾ç½®æ¥è‡ªåŠ¨åˆ¶å®šå­—ä½“æ ·å¼ã€‚
ä¸‹é¢è¡¨æ ¼ä¸­æ˜¯å…­ç§å¯ç”¨å­—ä½“æ ·å¼çš„ç¤ºä¾‹ï¼š

æœ€å·¦è¾¹ä¸€åˆ—æ˜¯æœ€å°å­—ä½“ï¼›ä¸­é—´ä¸€åˆ—æ˜¯æœ€å¤§å­—ä½“ï¼›æœ€å³è¾¹ä¸€åˆ—æ˜¯ç²—ä½“æ•ˆæœã€‚

ä½¿ç”¨ç³»ç»ŸåŠ¨æ€å­—ä½“æ ·å¼

ä½¿ç”¨åŠ¨æ€æ–‡æœ¬ï¼Œæ˜¯é€šè¿‡ç»™æ–‡æœ¬å­—ä½“è®¾ç½®å­—ä½“æ ·å¼styleè€Œä¸æ˜¯æŒ‡å®šå…·ä½“çš„å­—ä½“åç§°å’Œå¤§å°ã€‚è¿™æ ·ï¼Œç³»ç»Ÿä¼šåœ¨è¿è¡Œæ—¶è‡ªåŠ¨æ ¹æ®è¿™ä¸€æ ·å¼ä»¥åŠç”¨æˆ·çš„å­—ä½“å¤§å°è®¾ç½®æ¥é€‰æ‹©ä½¿ç”¨åˆé€‚çš„å­—ä½“ã€‚

preferredFontForTextStyle:æ–¹æ³•è®¾ç½®å­—ä½“æ ·å¼


æ‰“å¼€ NoteEditorViewController.m/swift åœ¨viewDidLoadï¼šæ–¹æ³•å®ç°çš„æœ€åé¢åŠ å…¥ä»¥ä¸‹ä»£ç ï¼š
{%codeblock lang:objc%}
self.textView.font = [UIFont preferredFontForTextStyle:UIFontTextStyleBody];
{%endcodeblock%}
{% codeblock  lang:swift %}
self.textView.font = UIFont.preferredFont(forTextStyle: .body)
{% endcodeblock %}
æ‰“å¼€ NotesListViewController.m/swift åœ¨ tableView:cellForRowAtIndexPath: æ–¹æ³•ä¸­å¢åŠ å¦‚ä¸‹ä»£ç :
{%codeblock lang:objc%}
cell.textLabel.font = [UIFont preferredFontForTextStyle:UIFontTextStyleHeadline];
{%endcodeblock%}
{% codeblock  lang:swift %}
cell.textLabel?.font = UIFont.preferredFont(forTextStyle: .headline)
{% endcodeblock %}
ä¸Šé¢ä¸¤è¡Œä»£ç éƒ½ç”¨åˆ°äº†æ–°ç‰ˆiOSçš„å­—ä½“æ ·å¼.
&gt; å­—ä½“æ ·å¼ï¼šé€šè¿‡è¯­ä¹‰æ³•å‘½åå­—ä½“ï¼Œä¾‹å¦‚ UIFontTextStyleSubHeadline, å¯ä»¥é¿å…åœ¨ä»£ç é‡Œæ¯ä¸€å¤„éƒ½æŒ‡å®šå…·ä½“çš„å­—ä½“åç§°å’Œæ ·å¼ï¼Œ è€Œä¸”ç¡®ä¿appèƒ½å¯¹ç”¨æˆ·çš„å­—ä½“å¤§å°è®¾ç½®åšå‡ºæ°å½“çš„å›åº”ã€‚


APPå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®


è®¾ç½®ç³»ç»Ÿå­—ä½“
è¿”å›åˆ°é€šç”¨-&gt;æ–‡å­—å¤§å°é‡æ–°ä¿®æ”¹å­—ä½“è®¾ç½®.
å†è¿è¡ŒApp, Noteé¡µé¢çš„æ–‡å­—å¤§å°æ˜¯å½“å‰è®¾å®šçš„å­—ä½“å¤§å°ï¼›å‰åæˆªå±å¯¹æ¯”,åˆ†è¾¨ç‡å°äº†ä¸€åŠã€‚

è®¾ç½®ç³»ç»Ÿå­—ä½“ç”Ÿæ•ˆ
å½“æˆ‘ä»¬è¿”å›åˆ°é€šç”¨-&gt;æ–‡å­—å¤§å°é‡æ–°ä¿®æ”¹å­—ä½“è®¾ç½®. å†æ‰“å¼€Noteé¡µé¢, ä¼šå‘ç°appå¹¶æ²¡æœ‰ç«‹å³å¯¹å­—ä½“è®¾ç½®çš„å˜åŒ–åšå‡ºç›¸åº”ååº”ã€‚


ç›‘å¬ç³»ç»Ÿé€šçŸ¥ï¼šå®ç°APPå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®

å½“ç”¨æˆ·ä¿®æ”¹äº†ä»–ä»¬çš„å­—ä½“å¤§å°è®¾ç½®ä¹‹åï¼Œè¿™ä¸€æ ·å¼å¯¹åº”çš„å­—ä½“å¹¶ä¸ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œå¿…é¡»é‡æ–°è¯·æ±‚æ‰èƒ½è·å–æ–°çš„å€¼ã€‚ç”¨æˆ·è®¾ç½®å˜åŒ–åï¼ŒpreferredFontForTextStyle:æ–¹æ³•è¿”å›çš„å­—ä½“ä¹Ÿä¼šå˜åŒ–ã€‚
1. æ·»åŠ ç›‘å¬ç³»ç»Ÿé€šçŸ¥UIContentSizeCategoryDidChangeNotificationé€šçŸ¥APPå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®çš„å˜åŒ–
æ‰“å¼€ NoteEditorViewController.m å¹¶åœ¨ viewDidLoad æ–¹æ³•çš„å®ç°çš„æœ€ååŠ å…¥ä»¥ä¸‹ä»£ç ï¼š
{%codeblock lang:objc%}
[[NSNotificationCenter defaultCenter]
                              addObserver:self
                                 selector:@selector(preferredContentSizeChanged:)
                                     name:UIContentSizeCategoryDidChangeNotification
                                   object:nil];
{%endcodeblock%}
{%codeblock lang:swift%}
//å­—ä½“å˜åŒ–é€šçŸ¥:è°ƒç”¨preferredContentSizeChanged:æ–¹æ³•
NotificationCenter.default.addObserver(self, selector: #selector(NoteEditorViewController.preferredContentSizeChanged(:)), name: NSNotification.Name.UIContentSizeCategoryDidChange, object: nil)
{%endcodeblock%}
2. æ·»åŠ ç³»ç»Ÿé€šçŸ¥å“åº”äº‹ä»¶
æ”¶åˆ°ç”¨äºæŒ‡å®šæœ¬ç±»æ¥æ”¶å­—ä½“è®¾å®šå˜åŒ–çš„é€šçŸ¥åï¼Œè°ƒç”¨preferredContentSizeChanged:æ–¹æ³•
åœ¨NoteEditorViewController.mä¸­viewDidLoadæ–¹æ³•ä¹‹åç´§æ¥ç€æ·»åŠ ä»¥ä¸‹æ–¹æ³•ï¼š
{%codeblock lang:objc%}
- (void)preferredContentSizeChanged:(NSNotification *)notification
{
    self.textView.font = [UIFont preferredFontForTextStyle:UIFontTextStyleBody];
}
{%endcodeblock%}
{%codeblock lang:swift %}
//å­—ä½“å˜åŒ–é€šçŸ¥æ—¶è°ƒç”¨
func preferredContentSizeChanged( notification:NSNotification)
{
    self.textView.font = UIFont.preferredFont(forTextStyle: .body)
}
{%endcodeblock%}
è¿™ä¸€æ–¹æ³•ä½œç”¨æ˜¯æ ¹æ®æ–°çš„å­—ä½“è®¾ç½®æ¥è®¾å®štextViewä¸­çš„å­—ä½“ã€‚
Buildå¹¶è¿è¡Œappï¼Œä¿®æ”¹å­—ä½“å¤§å°è®¾ç½®ï¼ŒNoteé¡µé¢å°±å¯ä»¥å³æ—¶æ›´æ–°å­—ä½“å¤§å°äº†ã€‚">


<meta itemprop="datePublished" content="2014-07-03T17:29:00&#43;08:00" />
<meta itemprop="dateModified" content="2019-08-08T17:46:02&#43;08:00" />
<meta itemprop="wordCount" content="9592">



<meta itemprop="keywords" content="TextKit,æ¡ˆä¾‹," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="TextKitä¹‹ä¾¿ç¬ºå®æˆ˜"/>
<meta name="twitter:description" content="ä¾¿ç¬ºç»ƒä¹ åŠŸèƒ½ç‚¹:

é€šè¿‡å®ç°ä»¥ä¸‹ç‰¹æ•ˆï¼Œç»ƒä¹ å¹¶æŒæ¡å¸ƒå±€ç®¡ç†å™¨ï¼ˆlayout mangerï¼‰ï¼Œæ–‡æœ¬å®¹å™¨ï¼ˆtext containersï¼‰å’Œæ–‡æœ¬å­˜å‚¨å™¨ï¼ˆtext storageï¼‰ç­‰ç”¨æ³•ã€‚
  * åŠ¨æ€æ ·å¼ï¼ˆDynamic typeï¼‰
  * å‡¸ç‰ˆå°åˆ·æ•ˆæœï¼ˆLetterpress effectsï¼‰
  * ç¯ç»•è·¯å¾„ï¼ˆExclusion pathsï¼‰
  * åŠ¨æ€æ–‡æœ¬æ ¼å¼åŠå­˜å‚¨ï¼ˆDynamic text formatting and storageï¼‰

è¿™ä¸ªåº”ç”¨ä¸­æˆ‘ä»¬å°†å®ç°å›æµæ–‡æœ¬ï¼Œå­—ä½“å¤§å°çš„åŠ¨æ€å˜æ¢ï¼Œä»¥åŠé—ªå›æ–‡æœ¬ç­‰æ•ˆæœã€‚
æ•ˆæœå›¾:

Appå¼€å§‹è¿è¡Œåè‡ªåŠ¨ç”Ÿæˆä¸€ç»„ä¾¿ç¬ºå®ä¾‹å¹¶åˆ©ç”¨tableViewControlleræ˜¾ç¤ºå‡ºæ¥ã€‚Storyboardså’Œseguesä¼šå°†è¢«é€‰ä¸­çš„å•å…ƒæ ¼æ‰€å¯¹åº”çš„ä¾¿ç¬ºå†…å®¹æ˜¾ç¤ºå‡ºæ¥ä»¥ä¾›ç”¨æˆ·ç¼–è¾‘ã€‚
é¡¹ç›®å¼€å‘åŒ…ï¼šNotepad.zip

åŠ¨æ€æ ·å¼

åŠ¨æ€æ ·å¼ï¼ˆDynamic typeï¼‰æ˜¯iOS 7é‡Œé¢å˜åŒ–æœ€å¤§çš„ç‰¹æ€§ä¹‹ä¸€; å®ƒä½¿å¾—appå¯ä»¥éµä»ç”¨æˆ·é€‰æ‹©çš„å­—ä½“å¤§å°å’Œç²—ç»†ã€‚
é€‰æ‹© é€šç”¨-&gt;æ–‡å­—å¤§å° æˆ– é€šç”¨-&gt;è¾…åŠ©åŠŸèƒ½ æ¥æŸ¥çœ‹appä¸­çš„å­—ä½“è®¾ç½®ã€‚


iOS 7 æ”¯æŒé€šè¿‡ç²—ä½“ã€è®¾ç½®å­—ä½“å¤§å°ç­‰æ–¹å¼æé«˜æ”¯æŒåŠ¨æ€æ–‡æœ¬çš„åº”ç”¨çš„æ˜“è¯»æ€§ã€‚
ä¾‹å¦‚UIFontæ–°å¢çš„ä¸€ä¸ªæ–¹æ³•ï¼š preferredFontForTextStyle ç”¨æ¥æ ¹æ®ç”¨æˆ·å¯¹å­—ä½“å¤§å°çš„è®¾ç½®æ¥è‡ªåŠ¨åˆ¶å®šå­—ä½“æ ·å¼ã€‚
ä¸‹é¢è¡¨æ ¼ä¸­æ˜¯å…­ç§å¯ç”¨å­—ä½“æ ·å¼çš„ç¤ºä¾‹ï¼š

æœ€å·¦è¾¹ä¸€åˆ—æ˜¯æœ€å°å­—ä½“ï¼›ä¸­é—´ä¸€åˆ—æ˜¯æœ€å¤§å­—ä½“ï¼›æœ€å³è¾¹ä¸€åˆ—æ˜¯ç²—ä½“æ•ˆæœã€‚

ä½¿ç”¨ç³»ç»ŸåŠ¨æ€å­—ä½“æ ·å¼

ä½¿ç”¨åŠ¨æ€æ–‡æœ¬ï¼Œæ˜¯é€šè¿‡ç»™æ–‡æœ¬å­—ä½“è®¾ç½®å­—ä½“æ ·å¼styleè€Œä¸æ˜¯æŒ‡å®šå…·ä½“çš„å­—ä½“åç§°å’Œå¤§å°ã€‚è¿™æ ·ï¼Œç³»ç»Ÿä¼šåœ¨è¿è¡Œæ—¶è‡ªåŠ¨æ ¹æ®è¿™ä¸€æ ·å¼ä»¥åŠç”¨æˆ·çš„å­—ä½“å¤§å°è®¾ç½®æ¥é€‰æ‹©ä½¿ç”¨åˆé€‚çš„å­—ä½“ã€‚

preferredFontForTextStyle:æ–¹æ³•è®¾ç½®å­—ä½“æ ·å¼


æ‰“å¼€ NoteEditorViewController.m/swift åœ¨viewDidLoadï¼šæ–¹æ³•å®ç°çš„æœ€åé¢åŠ å…¥ä»¥ä¸‹ä»£ç ï¼š
{%codeblock lang:objc%}
self.textView.font = [UIFont preferredFontForTextStyle:UIFontTextStyleBody];
{%endcodeblock%}
{% codeblock  lang:swift %}
self.textView.font = UIFont.preferredFont(forTextStyle: .body)
{% endcodeblock %}
æ‰“å¼€ NotesListViewController.m/swift åœ¨ tableView:cellForRowAtIndexPath: æ–¹æ³•ä¸­å¢åŠ å¦‚ä¸‹ä»£ç :
{%codeblock lang:objc%}
cell.textLabel.font = [UIFont preferredFontForTextStyle:UIFontTextStyleHeadline];
{%endcodeblock%}
{% codeblock  lang:swift %}
cell.textLabel?.font = UIFont.preferredFont(forTextStyle: .headline)
{% endcodeblock %}
ä¸Šé¢ä¸¤è¡Œä»£ç éƒ½ç”¨åˆ°äº†æ–°ç‰ˆiOSçš„å­—ä½“æ ·å¼.
&gt; å­—ä½“æ ·å¼ï¼šé€šè¿‡è¯­ä¹‰æ³•å‘½åå­—ä½“ï¼Œä¾‹å¦‚ UIFontTextStyleSubHeadline, å¯ä»¥é¿å…åœ¨ä»£ç é‡Œæ¯ä¸€å¤„éƒ½æŒ‡å®šå…·ä½“çš„å­—ä½“åç§°å’Œæ ·å¼ï¼Œ è€Œä¸”ç¡®ä¿appèƒ½å¯¹ç”¨æˆ·çš„å­—ä½“å¤§å°è®¾ç½®åšå‡ºæ°å½“çš„å›åº”ã€‚


APPå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®


è®¾ç½®ç³»ç»Ÿå­—ä½“
è¿”å›åˆ°é€šç”¨-&gt;æ–‡å­—å¤§å°é‡æ–°ä¿®æ”¹å­—ä½“è®¾ç½®.
å†è¿è¡ŒApp, Noteé¡µé¢çš„æ–‡å­—å¤§å°æ˜¯å½“å‰è®¾å®šçš„å­—ä½“å¤§å°ï¼›å‰åæˆªå±å¯¹æ¯”,åˆ†è¾¨ç‡å°äº†ä¸€åŠã€‚

è®¾ç½®ç³»ç»Ÿå­—ä½“ç”Ÿæ•ˆ
å½“æˆ‘ä»¬è¿”å›åˆ°é€šç”¨-&gt;æ–‡å­—å¤§å°é‡æ–°ä¿®æ”¹å­—ä½“è®¾ç½®. å†æ‰“å¼€Noteé¡µé¢, ä¼šå‘ç°appå¹¶æ²¡æœ‰ç«‹å³å¯¹å­—ä½“è®¾ç½®çš„å˜åŒ–åšå‡ºç›¸åº”ååº”ã€‚


ç›‘å¬ç³»ç»Ÿé€šçŸ¥ï¼šå®ç°APPå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®

å½“ç”¨æˆ·ä¿®æ”¹äº†ä»–ä»¬çš„å­—ä½“å¤§å°è®¾ç½®ä¹‹åï¼Œè¿™ä¸€æ ·å¼å¯¹åº”çš„å­—ä½“å¹¶ä¸ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œå¿…é¡»é‡æ–°è¯·æ±‚æ‰èƒ½è·å–æ–°çš„å€¼ã€‚ç”¨æˆ·è®¾ç½®å˜åŒ–åï¼ŒpreferredFontForTextStyle:æ–¹æ³•è¿”å›çš„å­—ä½“ä¹Ÿä¼šå˜åŒ–ã€‚
1. æ·»åŠ ç›‘å¬ç³»ç»Ÿé€šçŸ¥UIContentSizeCategoryDidChangeNotificationé€šçŸ¥APPå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®çš„å˜åŒ–
æ‰“å¼€ NoteEditorViewController.m å¹¶åœ¨ viewDidLoad æ–¹æ³•çš„å®ç°çš„æœ€ååŠ å…¥ä»¥ä¸‹ä»£ç ï¼š
{%codeblock lang:objc%}
[[NSNotificationCenter defaultCenter]
                              addObserver:self
                                 selector:@selector(preferredContentSizeChanged:)
                                     name:UIContentSizeCategoryDidChangeNotification
                                   object:nil];
{%endcodeblock%}
{%codeblock lang:swift%}
//å­—ä½“å˜åŒ–é€šçŸ¥:è°ƒç”¨preferredContentSizeChanged:æ–¹æ³•
NotificationCenter.default.addObserver(self, selector: #selector(NoteEditorViewController.preferredContentSizeChanged(:)), name: NSNotification.Name.UIContentSizeCategoryDidChange, object: nil)
{%endcodeblock%}
2. æ·»åŠ ç³»ç»Ÿé€šçŸ¥å“åº”äº‹ä»¶
æ”¶åˆ°ç”¨äºæŒ‡å®šæœ¬ç±»æ¥æ”¶å­—ä½“è®¾å®šå˜åŒ–çš„é€šçŸ¥åï¼Œè°ƒç”¨preferredContentSizeChanged:æ–¹æ³•
åœ¨NoteEditorViewController.mä¸­viewDidLoadæ–¹æ³•ä¹‹åç´§æ¥ç€æ·»åŠ ä»¥ä¸‹æ–¹æ³•ï¼š
{%codeblock lang:objc%}
- (void)preferredContentSizeChanged:(NSNotification *)notification
{
    self.textView.font = [UIFont preferredFontForTextStyle:UIFontTextStyleBody];
}
{%endcodeblock%}
{%codeblock lang:swift %}
//å­—ä½“å˜åŒ–é€šçŸ¥æ—¶è°ƒç”¨
func preferredContentSizeChanged( notification:NSNotification)
{
    self.textView.font = UIFont.preferredFont(forTextStyle: .body)
}
{%endcodeblock%}
è¿™ä¸€æ–¹æ³•ä½œç”¨æ˜¯æ ¹æ®æ–°çš„å­—ä½“è®¾ç½®æ¥è®¾å®štextViewä¸­çš„å­—ä½“ã€‚
Buildå¹¶è¿è¡Œappï¼Œä¿®æ”¹å­—ä½“å¤§å°è®¾ç½®ï¼ŒNoteé¡µé¢å°±å¯ä»¥å³æ—¶æ›´æ–°å­—ä½“å¤§å°äº†ã€‚"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Even</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">ä¸»é¡µ</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">å½’æ¡£</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">æ ‡ç­¾ğŸ·ï¸</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">åˆ†ç±»</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Even</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">ä¸»é¡µ</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">å½’æ¡£</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">æ ‡ç­¾ğŸ·ï¸</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">åˆ†ç±»</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">TextKitä¹‹ä¾¿ç¬ºå®æˆ˜</h1>

      <div class="post-meta">
        <span class="post-time"> 2014-07-03 </span>
        <div class="post-category">
            <a href="/categories/ios/"> iOS </a>
            <a href="/categories/%E6%8E%A7%E4%BB%B6/"> æ§ä»¶ </a>
            </div>
          <span class="more-meta"> çº¦ 9592 å­— </span>
          <span class="more-meta"> é¢„è®¡é˜…è¯» 20 åˆ†é’Ÿ </span>
        <span id="busuanzi_container_page_pv" class="more-meta"> <span id="busuanzi_value_page_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> æ¬¡é˜…è¯» </span>
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">æ–‡ç« ç›®å½•</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#ä¾¿ç¬ºç»ƒä¹ åŠŸèƒ½ç‚¹">ä¾¿ç¬ºç»ƒä¹ åŠŸèƒ½ç‚¹:</a></li>
<li><a href="#åŠ¨æ€æ ·å¼">åŠ¨æ€æ ·å¼</a>
<ul>
<li><a href="#ä½¿ç”¨ç³»ç»ŸåŠ¨æ€å­—ä½“æ ·å¼">ä½¿ç”¨ç³»ç»ŸåŠ¨æ€å­—ä½“æ ·å¼</a>
<ul>
<li><a href="#preferredfontfortextstyle-æ–¹æ³•è®¾ç½®å­—ä½“æ ·å¼"><code>preferredFontForTextStyle:</code>æ–¹æ³•è®¾ç½®å­—ä½“æ ·å¼</a></li>
<li><a href="#appå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®">APPå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®</a>
<ul>
<li><a href="#ç›‘å¬ç³»ç»Ÿé€šçŸ¥-å®ç°appå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®">ç›‘å¬ç³»ç»Ÿé€šçŸ¥ï¼šå®ç°APPå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®</a></li>
</ul></li>
</ul></li>
<li><a href="#æ›´æ–°å¸ƒå±€">æ›´æ–°å¸ƒå±€</a></li>
<li><a href="#å‡¸ç‰ˆå°åˆ·æ•ˆæœ-letterpress-effects">å‡¸ç‰ˆå°åˆ·æ•ˆæœï¼ˆLetterpress effectsï¼‰</a></li>
<li><a href="#ç¯ç»•è·¯å¾„-exclusion-paths">ç¯ç»•è·¯å¾„ï¼ˆExclusion pathsï¼‰</a>
<ul>
<li><a href="#æ·»åŠ è§†å›¾">æ·»åŠ è§†å›¾</a></li>
<li><a href="#è®¾ç½®è§†å›¾ä½ç½®åŠè‡ªåŠ¨é€‚åº”å¸ƒå±€-viewdidlayoutsubviews">è®¾ç½®è§†å›¾ä½ç½®åŠè‡ªåŠ¨é€‚åº”å¸ƒå±€ï¼š<code>viewDidLayoutSubviews</code></a></li>
<li><a href="#å“åº”ç³»ç»Ÿåå¥½è®¾ç½®å­—ä½“æ ·å¼">å“åº”ç³»ç»Ÿåå¥½è®¾ç½®å­—ä½“æ ·å¼</a></li>
</ul></li>
<li><a href="#æ–‡æœ¬ç¯ç»•è§†å›¾">æ–‡æœ¬ç¯ç»•è§†å›¾</a>
<ul>
<li><a href="#curvepathwithorigin-åˆ›å»ºæ–‡æœ¬å®¹å™¨çš„èµ›å°”è·¯å¾„">curvePathWithOrigin:åˆ›å»ºæ–‡æœ¬å®¹å™¨çš„èµ›å°”è·¯å¾„</a></li>
<li><a href="#è®¾ç½®æ–‡æœ¬å®¹å™¨çš„ç¯ç»•è·¯å¾„-exclusionpaths">è®¾ç½®æ–‡æœ¬å®¹å™¨çš„ç¯ç»•è·¯å¾„ï¼šexclusionPaths</a></li>
</ul></li>
</ul></li>
<li><a href="#åŠ¨æ€æ–‡æœ¬æ ¼å¼åŠå­˜å‚¨-dynamic-text-formatting-and-storage">åŠ¨æ€æ–‡æœ¬æ ¼å¼åŠå­˜å‚¨ï¼ˆDynamic text formatting and storageï¼‰</a>
<ul>
<li><a href="#text-kitæ–‡æœ¬ç³»ç»Ÿå·¥ä½œæœºåˆ¶">Text Kitæ–‡æœ¬ç³»ç»Ÿå·¥ä½œæœºåˆ¶</a></li>
<li><a href="#nstextstorage-æ–‡æœ¬å­˜å‚¨å™¨åŠ¨æ€æ·»åŠ æ–‡æœ¬å±æ€§"><code>NSTextStorage</code>æ–‡æœ¬å­˜å‚¨å™¨åŠ¨æ€æ·»åŠ æ–‡æœ¬å±æ€§</a>
<ul>
<li><a href="#åˆ›å»ºæ–‡æœ¬å­˜å‚¨å™¨nstextstorageå­ç±»">åˆ›å»ºæ–‡æœ¬å­˜å‚¨å™¨NSTextStorageå­ç±»</a></li>
<li><a href="#é‡è½½æ–‡æœ¬å­˜å‚¨å™¨çš„æ•°æ®æŒä¹…åŒ–å±‚æ–¹æ³•">é‡è½½æ–‡æœ¬å­˜å‚¨å™¨çš„æ•°æ®æŒä¹…åŒ–å±‚æ–¹æ³•</a></li>
<li><a href="#é‡è½½ç¼–è¾‘æ–‡æœ¬æ—¶é€šçŸ¥å¸ƒå±€ç®¡ç†å™¨çš„æ–¹æ³•">é‡è½½ç¼–è¾‘æ–‡æœ¬æ—¶é€šçŸ¥å¸ƒå±€ç®¡ç†å™¨çš„æ–¹æ³•</a></li>
<li><a href="#ç±»æ—ä»‹ç»">ç±»æ—ä»‹ç»</a></li>
</ul></li>
<li><a href="#åˆ›å»ºuitextviewä½¿ç”¨è‡ªå®šä¹‰text-kitå †æ ˆ">åˆ›å»ºUITextViewä½¿ç”¨è‡ªå®šä¹‰Text Kitå †æ ˆ</a>
<ul>
<li><a href="#storyboardåˆ›å»ºuitextviewæ—¶-text-kitç»„ä»¶åªè¯»é—®é¢˜">storyboardåˆ›å»ºUITextViewæ—¶ï¼ŒText Kitç»„ä»¶åªè¯»é—®é¢˜</a></li>
<li><a href="#åœ¨uitextviewä¸­ä½¿ç”¨è‡ªå®šä¹‰çš„syntaxhighlighttextstorage">åœ¨UITextViewä¸­ä½¿ç”¨è‡ªå®šä¹‰çš„SyntaxHighlightTextStorage</a>
<ul>
<li><a href="#æ¸…ç†ibç›¸å…³è®¾ç½®">æ¸…ç†IBç›¸å…³è®¾ç½®</a></li>
<li><a href="#æ‰‹åŠ¨åˆ›å»º-uitextview-å’Œtext-kitå †æ ˆ">æ‰‹åŠ¨åˆ›å»º<code>UITextView</code>å’ŒText Kitå †æ ˆ</a></li>
<li><a href="#åˆ›å»º-text-kit-å †æ ˆ">åˆ›å»º<code>Text Kit</code>å †æ ˆ</a></li>
<li><a href="#è‡ªå®šä¹‰è§†å›¾å®ç°åœ¨-storyboard-ä¸­è‡ªåŠ¨å¸ƒå±€çº¦æŸçš„æ•ˆæœ">è‡ªå®šä¹‰è§†å›¾å®ç°åœ¨<code>storyboard</code>ä¸­è‡ªåŠ¨å¸ƒå±€çº¦æŸçš„æ•ˆæœ</a></li>
</ul></li>
</ul></li>
<li><a href="#é€šè¿‡æ­£åˆ™ä¿®æ”¹æ–‡æœ¬å­˜å‚¨å™¨çš„åŠ¨æ€æ ¼å¼-dynamic-formatting">é€šè¿‡æ­£åˆ™ä¿®æ”¹æ–‡æœ¬å­˜å‚¨å™¨çš„åŠ¨æ€æ ¼å¼ï¼ˆDynamic formattingï¼‰</a>
<ul>
<li><a href="#processediting-å°†æ–‡æœ¬çš„å˜åŒ–é€šçŸ¥ç»™å¸ƒå±€ç®¡ç†å™¨"><code>processEditing</code>ï¼šå°†æ–‡æœ¬çš„å˜åŒ–é€šçŸ¥ç»™å¸ƒå±€ç®¡ç†å™¨</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h2 id="ä¾¿ç¬ºç»ƒä¹ åŠŸèƒ½ç‚¹">ä¾¿ç¬ºç»ƒä¹ åŠŸèƒ½ç‚¹:</h2>

<p>é€šè¿‡å®ç°ä»¥ä¸‹ç‰¹æ•ˆï¼Œç»ƒä¹ å¹¶æŒæ¡å¸ƒå±€ç®¡ç†å™¨ï¼ˆlayout mangerï¼‰ï¼Œæ–‡æœ¬å®¹å™¨ï¼ˆtext containersï¼‰å’Œæ–‡æœ¬å­˜å‚¨å™¨ï¼ˆtext storageï¼‰ç­‰ç”¨æ³•ã€‚
  * åŠ¨æ€æ ·å¼ï¼ˆDynamic typeï¼‰<br />
  * å‡¸ç‰ˆå°åˆ·æ•ˆæœï¼ˆLetterpress effectsï¼‰<br />
  * ç¯ç»•è·¯å¾„ï¼ˆExclusion pathsï¼‰<br />
  * åŠ¨æ€æ–‡æœ¬æ ¼å¼åŠå­˜å‚¨ï¼ˆDynamic text formatting and storageï¼‰</p>

<p>è¿™ä¸ªåº”ç”¨ä¸­æˆ‘ä»¬å°†å®ç°å›æµæ–‡æœ¬ï¼Œå­—ä½“å¤§å°çš„åŠ¨æ€å˜æ¢ï¼Œä»¥åŠé—ªå›æ–‡æœ¬ç­‰æ•ˆæœã€‚
æ•ˆæœå›¾:<br />
<img src="/images/bianqian.png" alt="image" /><br />
Appå¼€å§‹è¿è¡Œåè‡ªåŠ¨ç”Ÿæˆä¸€ç»„ä¾¿ç¬ºå®ä¾‹å¹¶åˆ©ç”¨<code>tableViewController</code>æ˜¾ç¤ºå‡ºæ¥ã€‚<code>Storyboards</code>å’Œ<code>segues</code>ä¼šå°†è¢«é€‰ä¸­çš„å•å…ƒæ ¼æ‰€å¯¹åº”çš„ä¾¿ç¬ºå†…å®¹æ˜¾ç¤ºå‡ºæ¥ä»¥ä¾›ç”¨æˆ·ç¼–è¾‘ã€‚
é¡¹ç›®å¼€å‘åŒ…ï¼š<a href="http://cdn4.raywenderlich.com/wp-content/uploads/2013/09/TextKitNotepad-starter.zip">Notepad.zip</a></p>

<h2 id="åŠ¨æ€æ ·å¼">åŠ¨æ€æ ·å¼</h2>

<p><code>åŠ¨æ€æ ·å¼ï¼ˆDynamic typeï¼‰</code>æ˜¯iOS 7é‡Œé¢å˜åŒ–æœ€å¤§çš„ç‰¹æ€§ä¹‹ä¸€; å®ƒä½¿å¾—appå¯ä»¥éµä»ç”¨æˆ·é€‰æ‹©çš„å­—ä½“å¤§å°å’Œç²—ç»†ã€‚
é€‰æ‹© <strong>é€šç”¨-&gt;æ–‡å­—å¤§å°</strong> æˆ– <strong>é€šç”¨-&gt;è¾…åŠ©åŠŸèƒ½</strong> æ¥æŸ¥çœ‹appä¸­çš„å­—ä½“è®¾ç½®ã€‚</p>

<p><img src="/images/UserTextPreferences.png" alt="image" /><br />
iOS 7 æ”¯æŒé€šè¿‡<code>ç²—ä½“</code>ã€<code>è®¾ç½®å­—ä½“å¤§å°</code>ç­‰æ–¹å¼æé«˜æ”¯æŒåŠ¨æ€æ–‡æœ¬çš„åº”ç”¨çš„æ˜“è¯»æ€§ã€‚
ä¾‹å¦‚<strong><code>UIFont</code></strong>æ–°å¢çš„ä¸€ä¸ªæ–¹æ³•ï¼š <strong><code>preferredFontForTextStyle</code></strong> ç”¨æ¥æ ¹æ®ç”¨æˆ·å¯¹å­—ä½“å¤§å°çš„è®¾ç½®æ¥è‡ªåŠ¨åˆ¶å®šå­—ä½“æ ·å¼ã€‚<br />
ä¸‹é¢è¡¨æ ¼ä¸­æ˜¯å…­ç§å¯ç”¨å­—ä½“æ ·å¼çš„ç¤ºä¾‹ï¼š<br />
<img src="/images/TextStyles.png" alt="image" /><br />
æœ€å·¦è¾¹ä¸€åˆ—æ˜¯æœ€å°å­—ä½“ï¼›ä¸­é—´ä¸€åˆ—æ˜¯æœ€å¤§å­—ä½“ï¼›æœ€å³è¾¹ä¸€åˆ—æ˜¯ç²—ä½“æ•ˆæœã€‚</p>

<h3 id="ä½¿ç”¨ç³»ç»ŸåŠ¨æ€å­—ä½“æ ·å¼">ä½¿ç”¨ç³»ç»ŸåŠ¨æ€å­—ä½“æ ·å¼</h3>

<p>ä½¿ç”¨åŠ¨æ€æ–‡æœ¬ï¼Œæ˜¯é€šè¿‡ç»™<code>æ–‡æœ¬å­—ä½“</code>è®¾ç½®å­—ä½“æ ·å¼<strong>style</strong>è€Œä¸æ˜¯æŒ‡å®šå…·ä½“çš„<code>å­—ä½“åç§°</code>å’Œ<code>å¤§å°</code>ã€‚è¿™æ ·ï¼Œç³»ç»Ÿä¼šåœ¨è¿è¡Œæ—¶è‡ªåŠ¨æ ¹æ®è¿™ä¸€æ ·å¼ä»¥åŠç”¨æˆ·çš„å­—ä½“å¤§å°è®¾ç½®æ¥é€‰æ‹©ä½¿ç”¨åˆé€‚çš„å­—ä½“ã€‚</p>

<h4 id="preferredfontfortextstyle-æ–¹æ³•è®¾ç½®å­—ä½“æ ·å¼"><code>preferredFontForTextStyle:</code>æ–¹æ³•è®¾ç½®å­—ä½“æ ·å¼</h4>

<ol>
<li>æ‰“å¼€ <code>NoteEditorViewController.m/swift</code> åœ¨<code>viewDidLoadï¼š</code>æ–¹æ³•å®ç°çš„æœ€åé¢åŠ å…¥ä»¥ä¸‹ä»£ç ï¼š
{%codeblock lang:objc%}
self.textView.font = [UIFont preferredFontForTextStyle:UIFontTextStyleBody];
{%endcodeblock%}
{% codeblock  lang:swift %}
self.textView.font = UIFont.preferredFont(forTextStyle: .body)
{% endcodeblock %}</li>
<li>æ‰“å¼€ <code>NotesListViewController.m/swift</code> åœ¨ <code>tableView:cellForRowAtIndexPath:</code> æ–¹æ³•ä¸­å¢åŠ å¦‚ä¸‹ä»£ç :
{%codeblock lang:objc%}
cell.textLabel.font = [UIFont preferredFontForTextStyle:UIFontTextStyleHeadline];
{%endcodeblock%}
{% codeblock  lang:swift %}
cell.textLabel?.font = UIFont.preferredFont(forTextStyle: .headline)
{% endcodeblock %}
ä¸Šé¢ä¸¤è¡Œä»£ç éƒ½ç”¨åˆ°äº†æ–°ç‰ˆiOSçš„å­—ä½“æ ·å¼.<br />
&gt; å­—ä½“æ ·å¼ï¼šé€šè¿‡è¯­ä¹‰æ³•å‘½åå­—ä½“ï¼Œä¾‹å¦‚ <code>UIFontTextStyleSubHeadline</code>, å¯ä»¥é¿å…åœ¨ä»£ç é‡Œæ¯ä¸€å¤„éƒ½æŒ‡å®šå…·ä½“çš„å­—ä½“åç§°å’Œæ ·å¼ï¼Œ è€Œä¸”ç¡®ä¿appèƒ½å¯¹ç”¨æˆ·çš„å­—ä½“å¤§å°è®¾ç½®åšå‡ºæ°å½“çš„å›åº”ã€‚</li>
</ol>

<h4 id="appå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®">APPå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®</h4>

<ol>
<li>è®¾ç½®ç³»ç»Ÿå­—ä½“
è¿”å›åˆ°<strong>é€šç”¨-&gt;æ–‡å­—å¤§å°</strong>é‡æ–°ä¿®æ”¹å­—ä½“è®¾ç½®.
å†è¿è¡ŒApp, <strong>Note</strong>é¡µé¢çš„æ–‡å­—å¤§å°æ˜¯å½“å‰è®¾å®šçš„å­—ä½“å¤§å°ï¼›å‰åæˆªå±å¯¹æ¯”,åˆ†è¾¨ç‡å°äº†ä¸€åŠã€‚<br />
<img src="/images/NotepadWithDynamicType.png" alt="image" /></li>
<li>è®¾ç½®ç³»ç»Ÿå­—ä½“ç”Ÿæ•ˆ
å½“æˆ‘ä»¬è¿”å›åˆ°<strong>é€šç”¨-&gt;æ–‡å­—å¤§å°</strong>é‡æ–°ä¿®æ”¹å­—ä½“è®¾ç½®. å†æ‰“å¼€<strong>Note</strong>é¡µé¢, ä¼šå‘ç°appå¹¶æ²¡æœ‰<strong>ç«‹å³</strong>å¯¹å­—ä½“è®¾ç½®çš„å˜åŒ–åšå‡ºç›¸åº”ååº”ã€‚</li>
</ol>

<h5 id="ç›‘å¬ç³»ç»Ÿé€šçŸ¥-å®ç°appå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®">ç›‘å¬ç³»ç»Ÿé€šçŸ¥ï¼šå®ç°APPå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®</h5>

<p>å½“ç”¨æˆ·ä¿®æ”¹äº†ä»–ä»¬çš„å­—ä½“å¤§å°è®¾ç½®ä¹‹åï¼Œè¿™ä¸€æ ·å¼å¯¹åº”çš„å­—ä½“å¹¶ä¸ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œå¿…é¡»é‡æ–°è¯·æ±‚æ‰èƒ½è·å–æ–°çš„å€¼ã€‚ç”¨æˆ·è®¾ç½®å˜åŒ–åï¼Œ<code>preferredFontForTextStyle:</code>æ–¹æ³•è¿”å›çš„å­—ä½“ä¹Ÿä¼šå˜åŒ–ã€‚
1. æ·»åŠ ç›‘å¬ç³»ç»Ÿé€šçŸ¥<code>UIContentSizeCategoryDidChangeNotification</code>é€šçŸ¥APPå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®çš„å˜åŒ–
æ‰“å¼€ <code>NoteEditorViewController.m</code> å¹¶åœ¨ <code>viewDidLoad</code> æ–¹æ³•çš„å®ç°çš„æœ€ååŠ å…¥ä»¥ä¸‹ä»£ç ï¼š
{%codeblock lang:objc%}
[[NSNotificationCenter defaultCenter]
                              addObserver:self
                                 selector:@selector(preferredContentSizeChanged:)
                                     name:UIContentSizeCategoryDidChangeNotification
                                   object:nil];
{%endcodeblock%}
{%codeblock lang:swift%}
//å­—ä½“å˜åŒ–é€šçŸ¥:è°ƒç”¨preferredContentSizeChanged:æ–¹æ³•
NotificationCenter.default.addObserver(self, selector: #selector(NoteEditorViewController.preferredContentSizeChanged(<em>:)), name: NSNotification.Name.UIContentSizeCategoryDidChange, object: nil)
{%endcodeblock%}
2. æ·»åŠ ç³»ç»Ÿé€šçŸ¥å“åº”äº‹ä»¶
æ”¶åˆ°ç”¨äºæŒ‡å®šæœ¬ç±»æ¥æ”¶å­—ä½“è®¾å®šå˜åŒ–çš„é€šçŸ¥åï¼Œè°ƒç”¨<code>preferredContentSizeChanged:</code>æ–¹æ³•
åœ¨<code>NoteEditorViewController.m</code>ä¸­<code>viewDidLoad</code>æ–¹æ³•ä¹‹åç´§æ¥ç€æ·»åŠ ä»¥ä¸‹æ–¹æ³•ï¼š
{%codeblock lang:objc%}
- (void)preferredContentSizeChanged:(NSNotification *)notification
{
    self.textView.font = [UIFont preferredFontForTextStyle:UIFontTextStyleBody];
}
{%endcodeblock%}
{%codeblock lang:swift %}
//å­—ä½“å˜åŒ–é€šçŸ¥æ—¶è°ƒç”¨
func preferredContentSizeChanged(</em> notification:NSNotification)
{
    self.textView.font = UIFont.preferredFont(forTextStyle: .body)
}
{%endcodeblock%}
è¿™ä¸€æ–¹æ³•ä½œç”¨æ˜¯æ ¹æ®æ–°çš„å­—ä½“è®¾ç½®æ¥è®¾å®š<code>textView</code>ä¸­çš„å­—ä½“ã€‚<br />
Buildå¹¶è¿è¡Œappï¼Œä¿®æ”¹å­—ä½“å¤§å°è®¾ç½®ï¼ŒNoteé¡µé¢å°±å¯ä»¥å³æ—¶æ›´æ–°å­—ä½“å¤§å°äº†ã€‚</p>

<h3 id="æ›´æ–°å¸ƒå±€">æ›´æ–°å¸ƒå±€</h3>

<p>ç°åœ¨ï¼Œå¦‚æœä½ æŠŠå­—ä½“è®¾ç½®åˆ°å¾ˆå°ï¼Œé‚£æ¯ä¸ªå•å…ƒæ ¼çš„ç©ºç™½åŒºåŸŸæ˜¯ä¸æ˜¯å¤ªå¤šäº†ï¼Œçœ‹ä¸Šå»æ–‡å­—æ¯”è¾ƒç¨€ç–ï¼Œå¦‚ä¸‹é¢æ‰€ç¤ºï¼š<br />
  <img src="/images/ChangingLayout.png" alt="image" /></p>

<p>è¿™æ˜¯<strong>åŠ¨æ€æ ·å¼</strong>æœ‰ç‚¹å°å¤æ‚çš„éƒ¨åˆ†ï¼šè¦ä¿è¯Appåœ¨å­—ä½“å¤§å°å˜åŒ–åï¼ŒåŒæ—¶ä¹Ÿä¿®æ”¹æ–‡å­—è¡¨æ ¼çš„è¡Œé«˜ã€‚<br />
åœ¨<code>NotesListViewController.m</code>ä¸­å®ç°<code>tableView:heightForRowAtIndexPath:</code> ä»£ç†æ–¹æ³•:
{%codeblock lang:objc%}
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath <em>)indexPath {
    static UILabel</em> label;
    if (!label) {
        label = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, FLT_MAX, FLT<em>MAX)];
        label.text = @&ldquo;test&rdquo;;
    }
    label.font = [UIFont preferredFontForTextStyle:UIFontTextStyleHeadline];
    [label sizeToFit];  //è‡ªé€‚åº”æ–‡æœ¬å†…å®¹å¤§å°
    return label.frame.size.height * 1.7;
}
{%endcodeblock%}
{% codeblock lang:swift %}
override func tableView(</em> tableView: UITableView, heightForRowAt indexPath: IndexPath) -&gt; CGFloat
{
    let label = UILabel.init(frame: CGRect.init(x: 0, y: 0, width: FLT_MAX, height: FLT_MAX))
    label.text = &ldquo;test&rdquo;
    let font = UIFont.preferredFont(forTextStyle: .headline)
    label.font = font
    label.sizeToFit()
    return label.frame.size.height * 1.7
}
{% endcodeblock %}</p>

<p>ä»¥ä¸Šä»£ç åˆ›å»ºäº†ä¸€ä¸ªå…±äº«çš„â€”â€”æˆ–è€…è¯´é™æ€çš„â€”â€”<strong>UILabel</strong>å®ä¾‹ï¼Œè®¾å®šå®ƒçš„å­—ä½“å’Œè¡¨ä¸­å•å…ƒæ ¼å†…æ–‡æœ¬å­—ä½“ä¸€è‡´ã€‚ç„¶åè°ƒç”¨å®ƒçš„<code>sizeToFit</code>æ–¹æ³•ï¼Œä½¿è¿™ä¸ª<code>label</code>çš„<code>frame</code>æ°å¥½èƒ½æ”¾å¾—ä¸‹å®ƒçš„å†…å®¹æ–‡å­—, ç„¶åæŠŠè¿™ä¸ª<code>label</code>çš„é«˜åº¦ä¹˜ä¸ª<code>1.7</code>ä½œä¸ºè¡¨å†…å•å…ƒæ ¼é«˜åº¦ã€‚<br />
Buildå¹¶è¿è¡Œappï¼Œä¿®æ”¹å­—ä½“å¤§å°è®¾ç½®ï¼Œè¡Œé«˜ä¹Ÿä¼šéšç€å­—ä½“å¤§å°çš„å˜åŒ–è€Œå˜åŒ–ã€‚ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br />
<img src="/images/TableViewAdaptsHeights.png" alt="image" /></p>

<h3 id="å‡¸ç‰ˆå°åˆ·æ•ˆæœ-letterpress-effects">å‡¸ç‰ˆå°åˆ·æ•ˆæœï¼ˆLetterpress effectsï¼‰</h3>

<p>å‡¸ç‰ˆå°åˆ·æ•ˆæœï¼ˆLetterpress effectsï¼‰ç»™æ–‡å­—åŠ ä¸Šç²¾è‡´çš„é˜´å½±å’Œé«˜å…‰æ˜¯æ–‡å­—çœ‹ä¸Šå»æœ‰ä¸€å®šç«‹ä½“æ„Ÿâ€”â€”å°±å¥½åƒè½»è½»åµŒå…¥å±å¹•é‡Œä¸€æ ·ã€‚<br />
&gt; <font size=3>æ³¨: ä½¿ç”¨â€œå‡¸ç‰ˆå°åˆ·ï¼ˆletterpressï¼‰â€è¿™ä¸€å°åˆ·æœ¯è¯­æ˜¯å‘æ—©æœŸå°åˆ·ä¸šçš„è‡´æ•¬ã€‚æ‰€è°“å‡¸ç‰ˆå°åˆ·ï¼Œå°±æ˜¯å°†æ¶‚ä¸Šæ²¹å¢¨çš„å›¾æ–‡å‡¸ç‰ˆåµŒåœ¨å°ç‰ˆä¸Šï¼Œç„¶ååœ¨çº¸é¢ä¸ŠæŒ‰å‹å°±æŠŠå›¾æ–‡å‡¸ç‰ˆä¸Šçš„æ²¹å¢¨è½¬ç§»åˆ°çº¸é¢ä¸Šäº†â€”â€”çº¸é¢å—åŠ›åœ¨æ–‡å­—è¾¹ç¼˜å½¢æˆå¥½çœ‹çš„çªèµ·ã€‚ç°åœ¨è¿™ä¸€å·¥è‰ºå·²å¹¿æ³›è¢«æ•°ç æ‰“å°æ‰€å–ä»£ã€‚</font></p>

<p>æ‰“å¼€NotesListViewController.m å°†<code>tableView:cellForRowAtIndexPath:</code>æ–¹æ³•ä¸­çš„ä»£ç ç”¨ä»¥ä¸‹ä»£ç æ›¿æ¢:<br />
{%codeblock lang:objc%}
    static NSString *CellIdentifier = @&ldquo;Cell&rdquo;;
    UITableViewCell <em>cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier
                                                            forIndexPath:indexPath];
    Note</em> note = [self notes][indexPath.row];</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></pre></td>
<td class="lntd">
<pre class="chroma">UIFont* font = [UIFont preferredFontForTextStyle:UIFontTextStyleHeadline];

UIColor* textColor = [UIColor colorWithRed:0.175f green:0.458f blue:0.831f alpha:1.0f];

NSDictionary *attrs = @{ NSForegroundColorAttributeName : textColor,
                                    NSFontAttributeName : font,
                              NSTextEffectAttributeName : NSTextEffectLetterpressStyle};

NSAttributedString* attrString = [[NSAttributedString alloc]
                                       initWithString:note.title
                                           attributes:attrs];
cell.textLabel.attributedText = attrString;
return cell;</pre></td></tr></table>
</div>
</div>
<p>{%endcodeblock%}
{% codeblock lang:swift %}
override func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -&gt; UITableViewCell
{<br />
    let cell = tableView.dequeueReusableCell(withIdentifier: &ldquo;noteListCell&rdquo;, for: indexPath)
    // Configure the cell&hellip;
    let note = notes[indexPath.row] as! NoteModel
    //cell.textLabel?.text = note.title
    let font = UIFont.preferredFont(forTextStyle: .headline)
    let textColor = UIColor.init(red: 0.175, green: 0.458, blue: 0.831, alpha: 1.0)
    //å­—ä½“å‡¸ç‰ˆå°åˆ·æ•ˆæœ
    let store:[String:Any] = [NSForegroundColorAttributeName:textColor,
    NSFontAttributeName:font,
    NSTextEffectAttributeName:NSTextEffectLetterpressStyle]
    cell.textLabel?.attributedText = NSAttributedString.init(string: note.title, attributes: store)
    return cell
}
{% endcodeblock %}</p>

<p>ä¸Šé¢çš„ä»£ç ä¸ºå•å…ƒæ ¼çš„æ ‡é¢˜åˆ›å»ºäº†ä¸€ä¸ªä½¿ç”¨äº†å‡¸ç‰ˆå°åˆ·æ•ˆæœçš„<strong><code>NSAttributedString</code></strong>ã€‚  <p>
Buildå¹¶è¿è¡Œappï¼Œ è¡¨æ ¼å°†æ˜¾ç¤ºå‡¸ç‰ˆå°åˆ·æ•ˆæœï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br />
<img src="/images/Letterpress.png" alt="image" /><br />
å‡¸ç‰ˆå°åˆ·æ•ˆæœæ˜¯å¾ˆç²¾å·§â€”â€”ä½†æ˜¯å¹¶ä¸è¡¨ç¤ºä½ å¯ä»¥éšæ„è¿‡åº¦ä½¿ç”¨å®ƒã€‚è§†è§‰ç‰¹æ•ˆèƒ½è®©æ–‡å­—çœ‹ä¸Šå»æ›´æœ‰è¶£ï¼Œä½†å¹¶ä¸è¡¨ç¤ºä¸€å®šèƒ½è®©ä½ çš„æ–‡å­—æ›´æ¸…æ™°æ˜“è¯»ã€‚</p>

<h3 id="ç¯ç»•è·¯å¾„-exclusion-paths">ç¯ç»•è·¯å¾„ï¼ˆExclusion pathsï¼‰</h3>

<p>æ–‡å­—ç¯ç»•å›¾ç‰‡æˆ–å…¶å®ƒå†…å®¹åˆ†å¸ƒæ˜¯å¤§å¤šæ•°æ–‡å­—å¤„ç†è½¯ä»¶çš„æ ‡å‡†ç‰¹æ€§ä¹‹ä¸€ã€‚<code>Text Kit</code>å…è®¸ä½ é€šè¿‡ç¯ç»•è·¯å¾„ï¼ˆ<code>exclusion paths</code>ï¼‰å°†æ–‡å­—æŒ‰ç…§å¤æ‚è·¯å¾„å’Œå½¢çŠ¶åˆ†å¸ƒã€‚</p>

<p>åœ¨ä¾¿ç¬ºå³ä¸Šè§’æ·»åŠ ä¸€ä¸ªæ›²çº¿å½¢è§†å›¾ï¼Œå‘ŠçŸ¥ç”¨æˆ·ä¾¿ç¬ºåˆ›å»ºçš„æ—¥æœŸï¼š<br />
* é¦–å…ˆæ·»åŠ ä¸€ä¸ªè§†å›¾<br />
* åˆ›å»ºä¸€ä¸ªç¯ç»•è·¯å¾„ï¼Œä½¿æ–‡å­—æŒ‰ç…§è¿™ä¸ªè·¯å¾„åˆ†å¸ƒã€‚</p>

<h4 id="æ·»åŠ è§†å›¾">æ·»åŠ è§†å›¾</h4>

<p>æ‰“å¼€ <code>NoteEditorViewController.m</code> åœ¨é¡¶éƒ¨çš„<code>imports</code>å’Œæ¥å£å®ç°ä¸­æ·»åŠ å˜é‡åŠ å…¥ä»¥ä¸‹ä»£ç ï¼š
{%codeblock lang:objc%}
#import &ldquo;TimeIndicatorView.h&rdquo;</p>

<p>@implementation NoteEditorViewController
{
    TimeIndicatorView* _timeView;
}
{%endcodeblock%}
å®ä¾‹åŒ–è¿™ä¸ªç”¨ä»¥æ˜¾ç¤ºæ–‡æœ¬åˆ›å»ºæ—¥æœŸçš„è§†å›¾å®ä¾‹ï¼Œå¹¶æŠŠå®ƒä½œä¸ºä¸€ä¸ªå­è§†å›¾æ·»åŠ è¿›å»
åœ¨NoteEditorViewController.mçš„<code>viewDidLoad</code>æ–¹æ³•çš„æœ€åæ·»åŠ ä»¥ä¸‹ä»£ç ï¼š
{%codeblock objc lang:objc%}
_timeView = [[TimeIndicatorView alloc] initWithDate:_note.timestamp];
[self.view addSubview:_timeView];
{%endcodeblock%}</p>

<h4 id="è®¾ç½®è§†å›¾ä½ç½®åŠè‡ªåŠ¨é€‚åº”å¸ƒå±€-viewdidlayoutsubviews">è®¾ç½®è§†å›¾ä½ç½®åŠè‡ªåŠ¨é€‚åº”å¸ƒå±€ï¼š<code>viewDidLayoutSubviews</code></h4>

<p>å½“<strong>NoteEditor</strong>è§†å›¾çš„æ§ä»¶è°ƒç”¨ç³»ç»Ÿæ–¹æ³•<code>viewDidLayoutSubviews</code>æ–¹æ³•ï¼Œå¯¹å­è§†å›¾è¿›è¡Œå¸ƒå±€æ—¶ï¼Œ<code>TimeIndicatorView</code>ä½œä¸ºå­æ§ä»¶ä¹Ÿéœ€è¦æœ‰ç›¸åº”çš„å˜åŒ–ã€‚<br />
åœ¨æ§ä»¶æ¥æ”¶åˆ°æ–‡æœ¬å†…å®¹çš„å°ºå¯¸å‘ç”Ÿäº†å˜åŒ–çš„æ—¶å€™è°ƒç”¨<code>updateTimeIndicatorFrame</code>ï¼š
1. ç¬¬ä¸€è°ƒç”¨<code>updateSize</code>æ¥è®¾å®š<code>_timeView</code>çš„å°ºå¯¸<br />
2. ç¬¬äºŒå°†<code>_timeView</code>æ”¾åœ¨å³ä¸Šè§’<br />
åœ¨NoteEditorViewController.m çš„æœ€åæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š
{%codeblock objc lang:objc%}
- (void)viewDidLayoutSubviews
{
    [self updateTimeIndicatorFrame];
}
- (void)updateTimeIndicatorFrame
{
    [_timeView updateSize];
    _timeView.frame = CGRectOffset(_timeView.frame,
                          self.view.frame.size.width - _timeView.frame.size.width, 0.0);
}
{%endcodeblock%}
{% codeblock swift lang:swift %}
//è§†å›¾çš„æ§ä»¶è°ƒç”¨viewDidLayoutSubviewså¯¹å­è§†å›¾è¿›è¡Œå¸ƒå±€æ—¶ï¼ŒTimeIndicatorViewä½œä¸ºå­æ§ä»¶ä¹Ÿéœ€è¦æœ‰ç›¸åº”çš„å˜åŒ–ã€‚
override func viewDidLayoutSubviews()
{
    updateTimeIndicatorFrame()
}</p>

<p>func updateTimeIndicatorFrame()
{
    //ç¬¬ä¸€è°ƒç”¨updateSizeæ¥è®¾å®š_timeViewçš„å°ºå¯¸
    timeIndicatorView.updateSize()
    //é€šè¿‡åç§»frameå‚æ•°ï¼Œå°†timeIndicatorViewæ”¾åœ¨å³ä¸Šè§’
    timeIndicatorView.frame = timeIndicatorView.frame.offsetBy(dx: ibTextView.frame.width - timeIndicatorView.frame.width,
                                                               dy: 0.0)
}
{% endcodeblock %}</p>

<h4 id="å“åº”ç³»ç»Ÿåå¥½è®¾ç½®å­—ä½“æ ·å¼">å“åº”ç³»ç»Ÿåå¥½è®¾ç½®å­—ä½“æ ·å¼</h4>

<p>ä¿®æ”¹<code>NoteEditorViewController.m</code>ä¸­<code>preferredContentSizeChanged:</code>æ–¹æ³•å¦‚ä¸‹ï¼š
{%codeblock lang:objc%}
- (void)preferredContentSizeChanged:(NSNotification *)n
{
    self.textView.font = [UIFont preferredFontForTextStyle:UIFontTextStyleBody];
    [self updateTimeIndicatorFrame];
}
{%endcodeblock%}
Buildå¹¶è¿è¡Œappï¼Œç‚¹å‡»é€‰æ‹©ä¸€ä¸ªä¾¿ç¬ºï¼Œæ—¥æœŸæ˜¾ç¤ºè§†å›¾å°†å‡ºç°åœ¨å³ä¸Šè§’ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br />
<img src="/images/TimIndicator.png" alt="ä¿®æ”¹è®¾å¤‡ä¸­æ–‡æœ¬å¤§å°è®¾ç½®ï¼Œè¿™ä¸ªè§†å›¾ä¹Ÿå°†è‡ªåŠ¨è°ƒæ•´åˆ°ç›¸åº”çš„åˆé€‚å°ºå¯¸" /></p>

<h3 id="æ–‡æœ¬ç¯ç»•è§†å›¾">æ–‡æœ¬ç¯ç»•è§†å›¾</h3>

<ol>
<li>æ ¹æ®æ—¥æœŸè§†å›¾<code>_timeView</code>åˆ›å»ºåŸºäºè´èµ›å°”è·¯å¾„çš„ç¯ç»•è·¯å¾„</li>
<li>è®¾ç½®æ–‡æœ¬å®¹å™¨çš„ç¯ç»•è·¯å¾„ï¼šä½¿ç”¨æ–‡æœ¬å®¹å™¨çš„exclusionPathså±æ€§æŒ‡å®šã€‚å®ƒæ˜¯ä¸€ä¸ªUIBezierPathæ•°ç»„ç±»å‹ã€‚</li>
</ol>

<h4 id="curvepathwithorigin-åˆ›å»ºæ–‡æœ¬å®¹å™¨çš„èµ›å°”è·¯å¾„">curvePathWithOrigin:åˆ›å»ºæ–‡æœ¬å®¹å™¨çš„èµ›å°”è·¯å¾„</h4>

<p>æ ¹æ®æ—¥æœŸè§†å›¾<code>_timeView</code>åˆ›å»ºåŸºäºè´èµ›å°”è·¯å¾„çš„ç¯ç»•è·¯å¾„
æ·»åŠ <code>curvePathWithOrigin:</code>æ–¹æ³•ï¼Œå®šä¹‰æ–‡æœ¬éµå¾ªçš„ç¯ç»•è·¯å¾„ï¼š
{%codeblock objc lang:objc%}
- (UIBezierPath *)curvePathWithOrigin:(CGPoint)origin
{
    return [UIBezierPath bezierPathWithArcCenter:origin
                                          radius: [self radiusToSurroundFrame:_label.frame]
                                      startAngle: -180.0f
                                        endAngle: 180.0f
                                       clockwise: YES];
}
{%endcodeblock%}
{% codeblock swift lang:swift %}
func curvePathWithOrigin(origin:CGPoint)-&gt;UIBezierPath
{
    //ç”»å¼§å½¢
    let path = UIBezierPath.init(arcCenter: origin,
    radius: radiusToSurroundFrame(frame: timeLabel.frame),
                             startAngle: -180,                //-180.0
                               endAngle: 180.0,               //CGFloat(M_PI * 2),   //180.0
                              clockwise: true)
    //        UIColor.blueColor().set()
    //        path.fill()
    //        UIColor.blueColor().set()
    return path
}</p>

<p>{% endcodeblock %}</p>

<h4 id="è®¾ç½®æ–‡æœ¬å®¹å™¨çš„ç¯ç»•è·¯å¾„-exclusionpaths">è®¾ç½®æ–‡æœ¬å®¹å™¨çš„ç¯ç»•è·¯å¾„ï¼šexclusionPaths</h4>

<p><code>exclusionPaths</code>æ˜¯<code>NSArray</code>ç±»å‹ï¼Œå› æ­¤ä¸€ä¸ªæ–‡æœ¬å®¹å™¨æ˜¯å¯ä»¥æ”¯æŒå¤šä¸ªç¯ç»•è·¯å¾„ï¼Œæ–‡æœ¬<strong>ç¯ç»•è·¯å¾„</strong>å‘ç”Ÿæ”¹å˜åä¼šé€šçŸ¥æ–‡æœ¬ç®¡ç†å™¨ï¼Œç„¶å<strong>ç¯ç»•è·¯å¾„</strong>çš„å˜åŒ–å°±å¯ä»¥åŠ¨æ€åœ°ï¼Œç”šè‡³æ˜¯åŠ¨ç”»å¼åœ°ä½“ç°åˆ°æ–‡æœ¬ä¸Šï¼
åœ¨<code>updateTimeIndicatorFrame</code>æ–¹æ³•å®ç°çš„æœ€åé¢æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š
{%codeblock objc lang:objc%}
{
    UIBezierPath* exclusionPath = [_timeView curvePathWithOrigin:_timeView.center];
    _textView.textContainer.exclusionPaths  = @[exclusionPath];
}
{%endcodeblock%}
{%codeblock swift lang:swift %}
{
    let exclusionPath = timeIndicatorView.curvePathWithOrigin(origin: timeIndicatorView.center)
    ibTextView.textContainer.exclusionPaths = [exclusionPath]
}
{%endcodeblock%}
Buildå¹¶è¿è¡Œappï¼Œé€‰æ‹©ä¸€ä¸ªä¾¿ç¬ºé¡¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br />
<img src="/images/ExclusionPath.png" alt="å®ç°æ–‡æœ¬ç¯ç»•æ•ˆæœ" /></p>

<h2 id="åŠ¨æ€æ–‡æœ¬æ ¼å¼åŠå­˜å‚¨-dynamic-text-formatting-and-storage">åŠ¨æ€æ–‡æœ¬æ ¼å¼åŠå­˜å‚¨ï¼ˆDynamic text formatting and storageï¼‰</h2>

<p>ä½ å·²ç»çœ‹åˆ°äº†<code>Text Kit</code>å¯ä»¥æ ¹æ®ç”¨æˆ·è®¾ç½®çš„å­—ä½“å¤§å°åŠ¨æ€åœ°è°ƒæ•´å­—ä½“ã€‚ä½†æ˜¯å¦‚æœå­—ä½“ä¹Ÿå¯ä»¥æ ¹æ®å®é™…çš„æ–‡å­—æœ¬èº«æ¥è¿›è¡ŒåŠ¨æ€æ›´æ–°æ˜¯ä¸æ˜¯ä¼šæ›´é…·å‘¢ï¼Ÿ<br />
å®ç°ç±»ä¼¼markdownè¯­æ³•çš„æ•ˆæœï¼š<br />
* æŠŠæ³¢æµªçº¿(~)ä¹‹é—´çš„æ–‡æœ¬å˜ä¸ºè‰ºæœ¯å­—ä½“<br />
* æŠŠä¸‹åˆ’çº¿(_)ä¹‹é—´çš„æ–‡æœ¬å˜ä¸ºæ–œä½“<br />
* ä¸ºç ´æŠ˜å·(-)ä¹‹é—´çš„æ–‡æœ¬æ·»åŠ åˆ é™¤çº¿<br />
* æŠŠå­—æ¯å…¨éƒ¨å¤§å†™çš„å•è¯å˜ä¸ºçº¢è‰²<br />
<img src="/images/DynamicTextExample.png" alt="åˆ©ç”¨Text Kit frameworkæ¥å®ç°çš„æ•ˆæœ" /></p>

<h3 id="text-kitæ–‡æœ¬ç³»ç»Ÿå·¥ä½œæœºåˆ¶">Text Kitæ–‡æœ¬ç³»ç»Ÿå·¥ä½œæœºåˆ¶</h3>

<p><code>Text Kit å †æ ˆ</code>å­˜å‚¨ã€å¤„ç†ä»¥åŠæ˜¾ç¤ºæ–‡æœ¬ï¼š<br />
<img src="/images/TextKitStack-443x320.png" alt="image" /><br />
å½“ä½ åˆ›å»º<code>UITextView</code>, <code>UILabel</code> or <code>UITextField</code>çš„æ—¶å€™ï¼ŒAppleç³»ç»Ÿè‡ªåŠ¨åœ¨åå°å¸®ä½ åˆ›å»ºäº†è¿™äº›ç±»ã€‚ä½ å¯ä»¥ä½¿ç”¨è¿™äº›é»˜è®¤çš„å®ç°æˆ–è€…æ˜¯è‡ªå®šä¹‰ä¸€éƒ¨åˆ†ï¼Œä»¥ä¾¿è¾¾åˆ°æƒ³è¦çš„æ•ˆæœã€‚
* <strong><code>NSTextStorage</code>æ–‡æœ¬å­˜å‚¨å™¨</strong>: ä½œä¸ºä¸€ä¸ª<code>NSMutableAttributedString</code>çš„å­ç±»ï¼ŒåŠ¨æ€å¤„ç†çš„æ–‡æœ¬å¯ä»¥é€šè¿‡<code>attributedString</code>çš„æ–¹å¼å­˜å‚¨ï¼Œå¹¶ä¸”å°†æ–‡æœ¬å†…å®¹çš„ä»»ä½•å˜åŒ–éƒ½é€šçŸ¥ç»™å¸ƒå±€ç®¡ç†å™¨ã€‚å¯ä»¥è‡ªå®šä¹‰<code>NSTextStorage</code>çš„å­ç±»ï¼Œå½“æ–‡æœ¬å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒåŠ¨æ€åœ°å¯¹æ–‡æœ¬å±æ€§åšå‡ºç›¸åº”æ”¹å˜ã€‚<br />
* <strong><code>NSLayoutManager</code>å¸ƒå±€å¼•æ“</strong>: è·å–å­˜å‚¨çš„æ–‡æœ¬å¹¶ç»è¿‡ä¿®é¥°å¤„ç†å†æ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼›
* <strong><code>NSTextContainer</code>æ–‡æœ¬å®¹å™¨</strong>: æè¿°æ‰€è¦å¤„ç†çš„æ–‡æœ¬åœ¨å±å¹•ä¸Šçš„ä½ç½®ä¿¡æ¯ã€‚æ¯ä¸€ä¸ªæ–‡æœ¬å®¹å™¨éƒ½æœ‰ä¸€ä¸ªå…³è”çš„<code>UITextView</code>. å¯ä»¥åˆ›å»º <code>NSTextContainer</code>çš„å­ç±»æ¥å®šä¹‰<strong>ä¸€ä¸ªå¤æ‚çš„å½¢çŠ¶</strong>ï¼Œç„¶ååœ¨è¿™ä¸ªå½¢çŠ¶å†…å¤„ç†æ–‡æœ¬ã€‚</p>

<h3 id="nstextstorage-æ–‡æœ¬å­˜å‚¨å™¨åŠ¨æ€æ·»åŠ æ–‡æœ¬å±æ€§"><code>NSTextStorage</code>æ–‡æœ¬å­˜å‚¨å™¨åŠ¨æ€æ·»åŠ æ–‡æœ¬å±æ€§</h3>

<ol>
<li>éœ€è¦åˆ›å»ºä¸€ä¸ª<code>NSTextStorage</code>çš„å­ç±»ï¼Œç”¨ä»¥åœ¨ç”¨æˆ·è¾“å…¥æ–‡æœ¬çš„æ—¶å€™ï¼ŒåŠ¨æ€åœ°æ·»åŠ æ–‡æœ¬å±æ€§ã€‚</li>
<li>å°†<code>UITextView</code>çš„é»˜è®¤æ–‡æœ¬å­˜å‚¨å™¨,ç”¨è‡ªå®šä¹‰çš„å®ç°æ›¿æ¢æ‰ã€‚</li>
</ol>

<h4 id="åˆ›å»ºæ–‡æœ¬å­˜å‚¨å™¨nstextstorageå­ç±»">åˆ›å»ºæ–‡æœ¬å­˜å‚¨å™¨NSTextStorageå­ç±»</h4>

<p>æ–°å»º<strong><code>NSTextStorage</code></strong>çš„å­ç±»ï¼Œç±»å‘½åä¸º<strong><code>SyntaxHighlightTextStorage</code></strong>
æ‰“å¼€<strong>SyntaxHighlightTextStorage.m</strong>å¹¶æ·»åŠ å®ä¾‹å˜é‡å¹¶åˆå§‹åŒ–ï¼š
{%codeblock lang:objc%}
#import &ldquo;SyntaxHighlightTextStorage.h&rdquo;
@implementation SyntaxHighlightTextStorage
{
    NSMutableAttributedString * _backingStore;
}</p>

<ul>
<li>(id)init
{
if (self = [super init])
{
    _backingStore = [NSMutableAttributedString new];
}
return self;
}
@end
{%endcodeblock%}</li>
</ul>

<p>{% codeblock swift lang:swift %}
class SyntaxHighlightTextStorage: NSTextStorage
{
    //æ–‡æœ¬å­˜å‚¨å™¨å­ç±»å¿…é¡»æä¾›å®ƒè‡ªå·±çš„â€œæ•°æ®æŒä¹…åŒ–å±‚â€ã€‚
    var backingStore = NSMutableAttributedString()
}</p>

<p>{% endcodeblock %}</p>

<h4 id="é‡è½½æ–‡æœ¬å­˜å‚¨å™¨çš„æ•°æ®æŒä¹…åŒ–å±‚æ–¹æ³•">é‡è½½æ–‡æœ¬å­˜å‚¨å™¨çš„æ•°æ®æŒä¹…åŒ–å±‚æ–¹æ³•</h4>

<p>è¦ä½¿ç”¨<strong><code>NSMutableAttributedString</code></strong>ä½œä¸ºâ€œåå°å­˜å‚¨â€ (åé¢ä¼šè¯¦ç»†è®²è§£)ï¼Œæ–‡æœ¬å­˜å‚¨å™¨å­ç±»å¿…é¡»æä¾›å®ƒè‡ªå·±çš„â€œæ•°æ®æŒä¹…åŒ–å±‚â€ï¼š
{%codeblock lang:objc%}
- (NSString *)string
{
    return [_backingStore string];
}</p>

<ul>
<li>(NSDictionary *)attributesAtIndex:(NSUInteger)location
                 effectiveRange:(NSRangePointer)range
{
return [_backingStore attributesAtIndex:location
                         effectiveRange:range];
}
{%endcodeblock%}
{% codeblock swift lang:swift %}
override var string: String
{
return backingStore.string
}</li>
</ul>

<p>override func attributes(at location: Int, effectiveRange range: NSRangePointer?) -&gt; [String : Any]
{
    if range == nil
    {
        return [:]
    }
    //print(&ldquo;backingStore:location(location),effectiveRange:(range!)&ldquo;)
    return backingStore.attributes(at: location, effectiveRange: range!)
}</p>

<p>{% endcodeblock %}
ä¸Šé¢ä¸¤ä¸ªæ–¹æ³•ç›´æ¥æŠŠä»»åŠ¡ä»£ç†ç»™äº†åå°å­˜å‚¨ã€‚</p>

<h4 id="é‡è½½ç¼–è¾‘æ–‡æœ¬æ—¶é€šçŸ¥å¸ƒå±€ç®¡ç†å™¨çš„æ–¹æ³•">é‡è½½ç¼–è¾‘æ–‡æœ¬æ—¶é€šçŸ¥å¸ƒå±€ç®¡ç†å™¨çš„æ–¹æ³•</h4>

<p>åŒæ ·çš„ï¼Œè¿™äº›æ–¹æ³•ä¹Ÿæ˜¯æŠŠä»»åŠ¡ä»£ç†ç»™åå°å­˜å‚¨ã€‚å®ƒä»¬é€šè¿‡è°ƒç”¨<code>beginEditing</code> / <code>edited</code> / <code>endEditing</code>è¿™äº›æ–¹æ³•æ¥å®Œæˆä¸€äº›ç¼–è¾‘ä»»åŠ¡ã€‚è¿™æ ·åšæ˜¯ä¸ºäº†åœ¨ç¼–è¾‘å‘ç”Ÿåè®©æ–‡æœ¬å­˜å‚¨å™¨çš„ç±»é€šçŸ¥ç›¸å…³çš„å¸ƒå±€ç®¡ç†å™¨ã€‚
æœ€åï¼Œè¿˜åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œé‡è½½ä»¥ä¸‹æ–¹æ³•ï¼š
{%codeblock lang:objc%}
- (void)replaceCharactersInRange:(NSRange)range withString:(NSString *)str
{
    NSLog(@&ldquo;replaceCharactersInRange:%@ withString:%@&ldquo;, NSStringFromRange(range), str);</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></pre></td>
<td class="lntd">
<pre class="chroma">[self beginEditing];
[_backingStore replaceCharactersInRange:range withString:str];
[self edited:NSTextStorageEditedCharacters | NSTextStorageEditedAttributes
          range:range
 changeInLength:str.length - range.length];
[self endEditing];</pre></td></tr></table>
</div>
</div>
<p>}</p>

<ul>
<li><p>(void)setAttributes:(NSDictionary *)attrs range:(NSRange)range
{
NSLog(@&ldquo;setAttributes:%@ range:%@&ldquo;, attrs, NSStringFromRange(range));</p>

<p>[self beginEditing];
[_backingStore setAttributes:attrs range:range];
[self edited:NSTextStorageEditedAttributes range:range changeInLength:0];
[self endEditing];
}
{%endcodeblock%}</p></li>
</ul>

<p>{% codeblock swift lang:swift %}
override func replaceCharacters(in range: NSRange, with str: String)
{
    print(&ldquo;replaceCharactersInRange:(NSStringFromRange(range)) withString:(str)&ldquo;)
    beginEditing()
    backingStore.replaceCharacters(in: range, with: str)
    edited([.editedAttributes,.editedCharacters], range: range, changeInLength: str.utf16.count - range.length)
    endEditing()
}</p>

<p>override func setAttributes(_ attrs: [String : Any]?, range: NSRange)
{
    //Sets the attributes for the characters in the specified range to the specified attributes.
    print(&ldquo;setAttributes:(attrs!) range:(NSStringFromRange(range))&ldquo;)
    beginEditing()
    backingStore.setAttributes(attrs!, range: range)
    edited(.editedAttributes, range: range, changeInLength: 0)
    endEditing()
}
{% endcodeblock %}</p>

<h4 id="ç±»æ—ä»‹ç»">ç±»æ—ä»‹ç»</h4>

<p>ç±»æ—æ˜¯Appleçš„frameworkä¸­å¹¿æ³›ç”¨åˆ°çš„ä¸€ç§è®¾è®¡æ¨¡å¼ã€‚ç±»æ—å°±æ˜¯æŠ½è±¡å·¥å‚æ¨¡å¼çš„å®ç°ï¼Œæ— éœ€æŒ‡å®šå…·ä½“çš„ç±»å°±å¯ä»¥ä¸ºåˆ›å»ºä¸€æ—ç›¸å…³æˆ–ä»å±çš„å¯¹è±¡æä¾›ä¸€ä¸ªå…¬å…±æ¥å£ã€‚ä¸€äº›æˆ‘ä»¬å¾ˆç†Ÿæ‚‰çš„ç±»<code>NSArray</code>å’Œ<code>NSNumber</code>ç±»ä¼¼çš„å°±æ˜¯ä¸€æ—ç±»çš„å…¬å…±æ¥å£ã€‚</p>

<p>ä¸Šä¾‹ä¸­<code>NSTextStorage</code>æ–‡æœ¬å­˜å‚¨å™¨å°±æ˜¯ä¸€ä¸ªç±»æ—çš„å…¬å…±æ¥å£ï¼Œéœ€è¦å¤§é‡ä»£ç æ¥åˆ›å»ºæ–‡æœ¬å­˜å‚¨å™¨çš„å­ç±»ã€‚åœ¨æ‰©å±•åŠŸèƒ½æ—¶ï¼Œé€šè¿‡åˆ›å»ºå­ç±»åŠé‡è½½å‡ ä¸ªæ–¹æ³•ä¹‹å¤–ï¼Œæœ‰äº›ç‰¹å®šéœ€æ±‚æ˜¯è¦è‡ªå·±å®ç°çš„ï¼Œæ¯”æ–¹<code>attributedString</code>æ•°æ®çš„åå°å­˜å‚¨ã€‚</p>

<p>Appleä½¿ç”¨ç±»æ—æ¥å°è£…åŒä¸€ä¸ªå…¬å…±<code>æŠ½è±¡è¶…ç±»</code>ä¸‹çš„ç§æœ‰å…·ä½“å­ç±»ï¼Œ<code>æŠ½è±¡è¶…ç±»</code>å£°æ˜äº†å®¢æˆ·åœ¨åˆ›å»º<code>ç§æœ‰å­ç±»å®ä¾‹</code>æ—¶å¿…é¡»è¦å®ç°çš„æ–¹æ³•ã€‚å®¢æˆ·æ˜¯å®Œå…¨æ— æ³•çŸ¥é“å·¥å‚æ­£åœ¨ç”¨å“ªä¸€ä¸ªç§æœ‰ç±»ï¼Œå®ƒåªå’Œå…¬å…±æ¥å£ç›¸äº’åä½œã€‚<br />
ä½¿ç”¨ç±»æ—å½“ç„¶å¯ä»¥ç®€åŒ–æ¥å£ï¼Œä½¿å­¦ä¹ å’Œä½¿ç”¨ç±»æ›´åŠ å®¹æ˜“ï¼Œä½†æ˜¯å¿…é¡»è¦éœ€è¦æŒ‡å‡ºçš„æ˜¯è¦åœ¨åŠŸèƒ½æ‰©å±•å’Œæ¥å£ç®€åŒ–ä¹‹é—´è¾¾åˆ°å¹³è¡¡ã€‚åˆ›å»ºä¸€ä¸ªç±»æ—çš„æŠ½è±¡è¶…ç±»çš„å®šåˆ¶å­ç±»ä¹Ÿå¸¸å¸¸æ˜¯éå¸¸éš¾çš„ã€‚</p>

<h3 id="åˆ›å»ºuitextviewä½¿ç”¨è‡ªå®šä¹‰text-kitå †æ ˆ">åˆ›å»ºUITextViewä½¿ç”¨è‡ªå®šä¹‰Text Kitå †æ ˆ</h3>

<p>ç°åœ¨æœ‰äº†ä¸€ä¸ªè‡ªå®šä¹‰çš„<code>NSTextStorage</code>ï¼Œè¿˜éœ€åˆ›å»ºä¸€ä¸ª<code>UITextView</code>æ¥ä½¿ç”¨å®ƒã€‚</p>

<h4 id="storyboardåˆ›å»ºuitextviewæ—¶-text-kitç»„ä»¶åªè¯»é—®é¢˜">storyboardåˆ›å»ºUITextViewæ—¶ï¼ŒText Kitç»„ä»¶åªè¯»é—®é¢˜</h4>

<p>ä»<strong>storyboard</strong>ç¼–è¾‘å™¨å®ä¾‹åŒ–<code>UITextView</code>ä¼šè‡ªåŠ¨åˆ›å»º<strong><code>NSTextStorage</code></strong>, <strong><code>NSLayoutManager</code></strong>å’Œ<strong><code>NSTextContainer</code></strong> (ä¾‹å¦‚<strong>Text Kit</strong>å †æ ˆ)å®ä¾‹ä»¥åŠæ‰€æœ‰çš„è¿™ä¸‰ä¸ªåªè¯»å±æ€§ã€‚<br />
è™½ç„¶æ²¡æœ‰åŠæ³•ä»<strong>storyboard</strong>ç¼–è¾‘å™¨ä¸­æ”¹å˜è¿™ç§è®¾å®šï¼Œä½†å¯ä»¥æ‰‹åŠ¨ç¼–ç¨‹åˆ›å»º<code>UITextView</code>å’Œ<strong>Text Kit</strong>å †æ ˆã€‚</p>

<h4 id="åœ¨uitextviewä¸­ä½¿ç”¨è‡ªå®šä¹‰çš„syntaxhighlighttextstorage">åœ¨UITextViewä¸­ä½¿ç”¨è‡ªå®šä¹‰çš„SyntaxHighlightTextStorage</h4>

<h5 id="æ¸…ç†ibç›¸å…³è®¾ç½®">æ¸…ç†IBç›¸å…³è®¾ç½®</h5>

<ul>
<li>åœ¨IBä¸­æ‰“å¼€<strong>Main.storyboard</strong> æ‰¾åˆ°<strong>NoteEditorViewController</strong>ã€‚ åˆ é™¤<code>UITextView</code>å®ä¾‹ã€‚
ç„¶åï¼Œæ‰“å¼€<strong>NoteEditorViewController.m</strong>åˆ é™¤<strong>UITextView outlet</strong>ã€‚
æ—¢ç„¶ä¸å†ä¸ºæ–‡æœ¬è§†å›¾ä½¿ç”¨<code>IBOutlet</code>ï¼Œè€Œæ˜¯è¦ç¼–ç¨‹æ·»åŠ ï¼Œæ‰€ä»¥ä¹Ÿå°±ä¸éœ€è¦è¿™äº›ä»£ç äº†ã€‚
ä»<code>viewDidLoad</code> æ–¹æ³•ä¸­åˆ é™¤ä»¥ä¸‹ä»£ç ï¼š
{%codeblock lang:objc%}
self.textView.text = self.note.contents;
self.textView.delegate = self;
self.textView.font = [UIFont preferredFontForTextStyle:UIFontTextStyleBody];
{%endcodeblock%}</li>
</ul>

<h5 id="æ‰‹åŠ¨åˆ›å»º-uitextview-å’Œtext-kitå †æ ˆ">æ‰‹åŠ¨åˆ›å»º<code>UITextView</code>å’ŒText Kitå †æ ˆ</h5>

<ul>
<li>åœ¨<strong>NoteEditorViewController.m</strong>æœ€ä¸Šé¢ï¼Œæ·»åŠ ä¸‹é¢ä¸€è¡Œä»£ç :
{%codeblock objc lang:objc %}
#import &ldquo;SyntaxHighlightTextStorage.h&rdquo;
{%endcodeblock%}
åœ¨NoteEditorViewController.mä¸­<code>TimeIndicatorView</code>å®ä¾‹å˜é‡åé¢ç´§æ¥ç€æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š
{%codeblock lang:objc%}
SyntaxHighlightTextStorage* _textStorage;
UITextView* _textView;
{%endcodeblock%}
æ–‡æœ¬å­˜å‚¨å™¨å­ç±»æœ‰ä¸¤ä¸ªå®ä¾‹å˜é‡ï¼Œè¿˜æœ‰ä¸€ä¸ªæ–‡æœ¬è§†å›¾ç¨åéœ€è¦æ·»åŠ ã€‚<br /></li>
</ul>

<h5 id="åˆ›å»º-text-kit-å †æ ˆ">åˆ›å»º<code>Text Kit</code>å †æ ˆ</h5>

<ul>
<li>åˆ›å»ºè‡ªå®šä¹‰çš„<code>NSTextStorage</code>æ–‡æœ¬å­˜å‚¨å™¨å®ä¾‹ï¼Œä¸€ä¸ªç”¨æ¥æ‰¿è½½ä¾¿ç¬ºå†…å®¹çš„<code>NSAttributedString</code><br /></li>
<li>åˆ›å»ºä¸€ä¸ª<code>NSLayoutManager</code>å¸ƒå±€ç®¡ç†å™¨ï¼Œå¹¶æ·»åŠ åˆ°æ–‡æœ¬å­˜å‚¨å™¨ã€‚</li>
<li>åˆ›å»ºä¸€ä¸ª<code>NSTextContainer</code>æ–‡æœ¬å®¹å™¨ï¼Œå¹¶æ·»åŠ åˆ°å¸ƒå±€ç®¡ç†å™¨ã€‚ç„¶åæŠŠå¸ƒå±€ç®¡ç†å™¨å’Œæ–‡æœ¬å­˜å‚¨å™¨è”ç³»èµ·æ¥<br /></li>
<li>æœ€åç”¨ä½ è‡ªå®šä¹‰çš„æ–‡æœ¬å®¹å™¨å’Œä»£ç†ç»„åˆ›å»ºå®é™…çš„æ–‡æœ¬è§†å›¾ï¼Œ  å¹¶æŠŠæ–‡æœ¬è§†å›¾æ·»åŠ ä¸ºå­è§†å›¾<br />
åœ¨NoteEditorViewController.mä¸­ï¼Œæ·»åŠ ä¸‹é¢æ–¹æ³•ï¼š
{%codeblock lang:objc%}</li>

<li><p>(void)createTextView
{
// 1. Create the text storage that backs the editor
NSDictionary* attrs = @{NSFontAttributeName:
    [UIFont preferredFontForTextStyle:UIFontTextStyleBody]};
NSAttributedString* attrString = [[NSAttributedString alloc]
                               initWithString:_note.contents
                                   attributes:attrs];
_textStorage = [SyntaxHighlightTextStorage new];
[_textStorage appendAttributedString:attrString];</p>

<p>CGRect newTextViewRect = self.view.bounds;</p>

<p>// 2. Create the layout manager
NSLayoutManager *layoutManager = [[NSLayoutManager alloc] init];</p>

<p>// 3. Create a text container
CGSize containerSize = CGSizeMake(newTextViewRect.size.width,  CGFLOAT_MAX);
NSTextContainer *container = [[NSTextContainer alloc] initWithSize:containerSize];
container.widthTracksTextView = YES;
[layoutManager addTextContainer:container];
[_textStorage addLayoutManager:layoutManager];</p>

<p>// 4. Create a UITextView
_textView = [[UITextView alloc] initWithFrame:newTextViewRect
                                textContainer:container];
_textView.delegate = self;
[self.view addSubview:_textView];
}
{%endcodeblock%}
{% codeblock swift lang:swift %}
//åˆ›å»ºæ–‡æœ¬åŒºåŸŸ
func createTextView()
{
// 1. Create the text storage that backs the editor
let bodyFont = UIFont.preferredFont(forTextStyle: UIFontTextStyle.body)
let attrs = [NSFontAttributeName:bodyFont]
let attrString = NSAttributedString(string: note.contents,attributes: attrs)
textStorage = SyntaxHighlightTextStorage()
textStorage.append(attrString)</p>

<p>// &mdash;&mdash;&ndash;ä½¿ç”¨Storyboardå£°æ˜TextViewæ—¶,åªéœ€ä¸€è¡Œï¼Œå¯æƒœä¸ºåªè¯»å±æ€§&mdash;&mdash;&mdash;-
textStorage.addLayoutManager(ibTextView.layoutManager)</p>

<p>/**&mdash;&mdash;&ndash;ä½¿ç”¨ä»£ç å£°æ˜TextViewæ—¶ï¼Œ4æ­¥éª¤&mdash;&mdash;&mdash;-
let newTextViewRect = view.bounds</p>

<p>// 2. Create the layout manager
let layoutManager = NSLayoutManager()</p>

<p>// 3. Create a text container
//æ–‡æœ¬å®¹å™¨çš„å®½åº¦ä¼šè‡ªåŠ¨åŒ¹é…è§†å›¾çš„å®½åº¦ï¼Œä½†æ˜¯å®ƒçš„é«˜åº¦æ˜¯æ— é™é«˜çš„â€”â€”æˆ–è€…è¯´æ— é™æ¥è¿‘äºCGFloat.maxï¼Œå®ƒçš„å€¼å¯ä»¥æ˜¯æ— é™å¤§ã€‚
let containerSize = CGSize.init(width: newTextViewRect.size.width,
height: CGFloat.greatestFiniteMagnitude)</p>

<p>let container = NSTextContainer.init(size: containerSize)
//A Boolean that controls whether the receiver adjusts the width of its bounding rectangle when its text view is resized.
container.widthTracksTextView = true
//
layoutManager.addTextContainer(container)
textStorage.addLayoutManager(layoutManager)</p>

<p>// 4. Create a UITextView
textView = UITextView()//.init(frame: newTextViewRect, textContainer: container)
textView.isScrollEnabled = true
textView.delegate = self
view.addSubview(textView)
*/
}
{% endcodeblock %}</p></li>
</ul>

<p>ç°åœ¨å›é¡¾ä¹‹å‰é‚£ä¸ªå›¾è¡¨æ‰€å±•ç¤ºçš„å››ä¸ªå…³é”®ç±»(æ–‡æœ¬å­˜å‚¨å™¨<code>storage</code>, å¸ƒå±€ç®¡ç†å™¨<code>layout manager</code>, æ–‡æœ¬å®¹å™¨<code>container</code> å’Œæ–‡æœ¬è§†å›¾<code>textView</code>)ä¹‹é—´çš„å…³ç³»ï¼Œæ˜¯ä¸æ˜¯è§‰å¾—ç†è§£èµ·æ¥å®¹æ˜“å¤šäº†ã€‚<br />
<img src="/images/TextKitStack-443x320.png" alt="image" />
&gt;<font size=3>æ³¨æ„:æ–‡æœ¬å®¹å™¨çš„å®½åº¦ä¼šè‡ªåŠ¨åŒ¹é…è§†å›¾çš„å®½åº¦ï¼Œä½†æ˜¯å®ƒçš„é«˜åº¦æ˜¯æ— é™é«˜çš„â€”â€”æˆ–è€…è¯´æ— é™æ¥è¿‘äº<code>CGFLOAT_MAX</code>ï¼Œå®ƒçš„å€¼å¯ä»¥æ˜¯æ— é™å¤§ã€‚ä¸ç®¡æ€ä¹ˆè¯´ï¼Œå®ƒçš„é«˜åº¦è¶³å¤Ÿè®©<code>UITextView</code>ä¸Šä¸‹æ»šåŠ¨ä»¥å®¹çº³å¾ˆé•¿çš„æ–‡æœ¬ã€‚</font></p>

<p>åœ¨<code>viewDidLoad</code>æ–¹æ³•ä¸­è°ƒç”¨è¶…ç±»çš„<code>viewDidLoad</code>æ–¹æ³•çš„è¯­å¥åé¢æ·»åŠ ä»¥ä¸‹ä¸€è¡Œä»£ç ï¼š
{%codeblock lang:objc%}
[self createTextView];
{%endcodeblock%}
ç„¶åä¿®æ”¹<code>preferredContentSizeChanged</code>çš„ç¬¬ä¸€è¡Œä»£ç ä¸ºï¼š
{%codeblock lang:objc%}
_textView.font = [UIFont preferredFontForTextStyle:UIFontTextStyleBody];
{%endcodeblock%}</p>

<h5 id="è‡ªå®šä¹‰è§†å›¾å®ç°åœ¨-storyboard-ä¸­è‡ªåŠ¨å¸ƒå±€çº¦æŸçš„æ•ˆæœ">è‡ªå®šä¹‰è§†å›¾å®ç°åœ¨<code>storyboard</code>ä¸­è‡ªåŠ¨å¸ƒå±€çº¦æŸçš„æ•ˆæœ</h5>

<p>ç”¨è‡ªå®šä¹‰çš„å®ä¾‹å˜é‡æ¥æ›¿æ¢æ‰æ—§çš„<code>outlet</code>å±æ€§ã€‚è‡ªå®šä¹‰è§†å›¾ä¸ä¼šè‡ªåŠ¨ç»§æ‰¿<code>storyboard</code>ä¸­çš„å¸ƒå±€çº¦æŸç»„çš„è§„åˆ™ã€‚å½“è®¾å¤‡æ–¹å‘å˜åŒ–åï¼Œè§†å›¾çš„è¾¹ç•Œæ˜¯ä¸ä¼šè‡ªåŠ¨éšä¹‹æ”¹å˜çš„ï¼Œè¿™æ ·å°±éœ€è¦è‡ªå·±æ¥ç¼–ç¨‹è®¾å®šè§†å›¾è¾¹ç•Œã€‚</p>

<p>å¯ä»¥åœ¨<code>viewDidLayoutSubviews</code>æ–¹æ³•çš„æœ€åæ·»åŠ ä»¥ä¸‹ä»£ç æ¥å®ç°ï¼š
{%codeblock lang:objc%}
_textView.frame = self.view.bounds;
{%endcodeblock%}
Buildå¹¶è¿è¡Œappï¼Œæ‰“å¼€ä¸€ä¸ªä¾¿ç¬ºé¡¹ï¼Œåœ¨Xcodeæ§åˆ¶å°ä¸Šæœ‰<code>SyntaxHighlightTextStorage</code>ç”Ÿæˆçš„è¿è¡Œæ—¥å¿—ï¼Œç”¨æ¥å‘Šè¯‰ä½ è¿™äº›æ–‡æœ¬å¤„ç†çš„ä»£ç ç¡®å®è¢«è°ƒç”¨ï¼š<br />
<img src="/images/LogMessages-480x266.png" alt="image" />
çœ‹æ¥ä½ çš„æ–‡æœ¬è§£æå™¨çš„åŸºç¡€éå¸¸å¯é äº† â€”â€” é‚£ç°åœ¨æ¥æ·»åŠ åŠ¨æ€æ ¼å¼ã€‚</p>

<h3 id="é€šè¿‡æ­£åˆ™ä¿®æ”¹æ–‡æœ¬å­˜å‚¨å™¨çš„åŠ¨æ€æ ¼å¼-dynamic-formatting">é€šè¿‡æ­£åˆ™ä¿®æ”¹æ–‡æœ¬å­˜å‚¨å™¨çš„åŠ¨æ€æ ¼å¼ï¼ˆDynamic formattingï¼‰</h3>

<p>æ¥ä¸‹æ¥å°†å¯¹ä½ çš„è‡ªå®šä¹‰æ–‡æœ¬å­˜å‚¨å™¨è¿›è¡Œä¿®æ”¹ä»¥å°†ï¼Šæ˜Ÿå·ç¬¦ä¹‹é—´çš„æ–‡æœ¬ï¼Šå˜ä¸ºé»‘ä½“ï¼š</p>

<h4 id="processediting-å°†æ–‡æœ¬çš„å˜åŒ–é€šçŸ¥ç»™å¸ƒå±€ç®¡ç†å™¨"><code>processEditing</code>ï¼šå°†æ–‡æœ¬çš„å˜åŒ–é€šçŸ¥ç»™å¸ƒå±€ç®¡ç†å™¨</h4>

<p><code>processEditing</code> å°†æ–‡æœ¬çš„å˜åŒ–é€šçŸ¥ç»™å¸ƒå±€ç®¡ç†å™¨ã€‚å®ƒä¹Ÿä¸ºæ–‡æœ¬ç¼–è¾‘ä¹‹åçš„å¤„ç†æä¾›ä¾¿åˆ©ã€‚
æ‰“å¼€<strong>SyntaxHighlightTextStorage.m</strong> æ·»åŠ ä»¥ä¸‹æ–¹æ³•ï¼š
{%codeblock lang:objc%}
-(void)processEditing
{
    [self performReplacementsForRange:[self editedRange]];
    [super processEditing];
}
{%endcodeblock%}</p>

<p>NSUnionRangeï¼šåœ¨range1å’Œrange2ä¹‹é—´æ¯”è¾ƒï¼Œå¦‚æœä¸€ä¸ªrangeå®Œå…¨åŒ…å«åœ¨å¦ä¸€ä¸ªrangeå†…ï¼Œåˆ™è¿”å›è¾ƒå¤§çš„range
ä¸Šé¢çš„ä»£ç æ‹“å±•äº†å—é»‘ä½“æ ¼å¼ç±»å‹å½±å“çš„æ–‡æœ¬èŒƒå›´ã€‚å› ä¸º<code>changedRange</code>ä¸€èˆ¬åªæ˜¯ä½œç”¨åˆ°å•ç‹¬çš„ä¸€ä¸ªå­—ç¬¦ï¼› è€Œ<code>lineRangeForRange</code> åˆ™æ‰©å±•åˆ°ä¸€æ•´è¡Œ
åœ¨ <code>processEditing</code>æ–¹æ³•ä¹‹åç´§æ¥ç€æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š
{%codeblock lang:objc%}
- (void)performReplacementsForRange:(NSRange)changedRange
{
    NSRange extendedRange = NSUnionRange(changedRange, [[_backingStore string]
                             lineRangeForRange:NSMakeRange(changedRange.location, 0)]);
    extendedRange = NSUnionRange(changedRange, [[<em>backingStore string]
                          lineRangeForRange:NSMakeRange(NSMaxRange(changedRange), 0)]);
    [self applyStylesToRange:extendedRange];
}
{%endcodeblock%}
{% codeblock swift lang:swift %}
//åœ¨æŒ‡å®šçš„åŒºåŸŸä¸­è¿›è¡Œæ›¿æ¢
func performReplacementsForRange(</em> changedRange:NSRange)
{
    //å®šä½æ­£åœ¨ç¼–è¾‘æ–‡æœ¬çš„ä½ç½®åŒºé—´
    let locationRange = NSMakeRange(changedRange.location, 0)
    //å®šä½åˆ°æ–‡æœ¬å½“å‰è¡Œçš„ä½ç½®åŒºé—´
    let range1 = (backingStore.string as NSString).lineRange(for: locationRange)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></pre></td>
<td class="lntd">
<pre class="chroma">//æ‰©å±•èŒƒå›´
var extendedRange = NSUnionRange(changedRange, range1)

let maxRange = NSMakeRange(NSMaxRange(changedRange), 0)

let range2 = (backingStore.string as NSString).lineRange(for: maxRange)
extendedRange = NSUnionRange(changedRange, range2)

print(&#34;åœ¨æŒ‡å®šçš„åŒºåŸŸä¸­è¿›è¡Œæ›¿æ¢:\(extendedRange)&#34;)
applyStylesToRange(searchRange: extendedRange)</pre></td></tr></table>
</div>
</div>
<p>}</p>

<p>{% endcodeblock %}</p>

<p>åœ¨ <code>performReplacementsForRange</code>æ–¹æ³•ä¹‹åç´§æ¥ç€æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š
{%codeblock lang:objc%}
- (void)applyStylesToRange:(NSRange)searchRange
{
    // 1. create some fonts
    UIFontDescriptor* fontDescriptor = [UIFontDescriptor
                             preferredFontDescriptorWithTextStyle:UIFontTextStyleBody];
    UIFontDescriptor* boldFontDescriptor = [fontDescriptor
                           fontDescriptorWithSymbolicTraits:UIFontDescriptorTraitBold];
    UIFont* boldFont =  [UIFont fontWithDescriptor:boldFontDescriptor size: 0.0];
    UIFont* normalFont =  [UIFont preferredFontForTextStyle:UIFontTextStyleBody];</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></pre></td>
<td class="lntd">
<pre class="chroma">// 2. match items surrounded by asterisks
NSString* regexStr = @&#34;(*w+(sw+)**)s&#34;;
NSRegularExpression* regex = [NSRegularExpression
                               regularExpressionWithPattern:regexStr
                                                    options:0
                                                      error:nil];

NSDictionary* boldAttributes = @{ NSFontAttributeName : boldFont };
NSDictionary* normalAttributes = @{ NSFontAttributeName : normalFont };

// 3. iterate over each match, making the text bold
[regex enumerateMatchesInString:[_backingStore string]
          options:0
            range:searchRange
       usingBlock:^(NSTextCheckingResult *match,
                    NSMatchingFlags flags,
                    BOOL *stop){

    NSRange matchRange = [match rangeAtIndex:1];
    [self addAttributes:boldAttributes range:matchRange];

    // 4. reset the style to the original
    if (NSMaxRange(matchRange)+1 &lt; self.length) {
        [self addAttributes:normalAttributes
            range:NSMakeRange(NSMaxRange(matchRange)+1, 1)];
    }
}];</pre></td></tr></table>
</div>
</div>
<p>}
{%endcodeblock%}
ä¸Šé¢çš„ä»£ç æœ‰ä»¥ä¸‹ä½œç”¨ï¼š</p>

<ol>
<li>åˆ›å»ºä¸€ä¸ªç²—ä½“åŠä¸€ä¸ªæ­£å¸¸å­—ä½“å¹¶ä½¿ç”¨å­—ä½“æè¿°å™¨ï¼ˆ<strong>Font descriptors</strong>ï¼‰æ¥æ ¼å¼åŒ–æ–‡æœ¬ã€‚å­—ä½“æè¿°å™¨èƒ½ä½¿ä½ æ— éœ€å¯¹å­—ä½“æ‰‹åŠ¨ç¼–ç æ¥è®¾ç½®å­—ä½“å’Œæ ·å¼ã€‚<br /></li>
<li>åˆ›å»ºä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¥å®šä½æ˜Ÿå·ç¬¦åŒ…å›´çš„æ–‡æœ¬ã€‚ä¾‹å¦‚ï¼Œåœ¨å­—ç¬¦ä¸²â€œiOS 7 is *awesome*â€ä¸­ï¼Œå­˜å‚¨åœ¨regExSträ¸­çš„æ­£åˆ™è¡¨è¾¾å¼å°†ä¼šåŒ¹é…å¹¶è¿”å›æ–‡æœ¬â€œ*awesome*â€ã€‚</li>
<li>å¯¹æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…åˆ°å¹¶è¿”å›çš„æ–‡æœ¬è¿›è¡Œæšä¸¾å¹¶æ·»åŠ ç²—ä½“å±æ€§ã€‚<br /></li>
</ol>

<p>å°†åä¸€ä¸ªæ˜Ÿå·ç¬¦ä¹‹åçš„æ–‡æœ¬éƒ½é‡ç½®ä¸ºâ€œå¸¸è§„â€æ ·å¼ã€‚ä»¥ä¿è¯æ·»åŠ åœ¨åä¸€ä¸ªæ˜Ÿå·ç¬¦ä¹‹åçš„æ–‡æœ¬ä¸è¢«ç²—ä½“é£æ ¼æ‰€å½±å“ã€‚
&gt; <font size=3>æ³¨ï¼š å­—ä½“æè¿°å™¨ï¼ˆ<strong>Font descriptors</strong>ï¼‰æ˜¯ä¸€ç§æè¿°æ€§è¯­è¨€ï¼Œå®ƒä½¿ä½ å¯ä»¥é€šè¿‡è®¾ç½®å±æ€§æ¥ä¿®æ”¹å­—ä½“ï¼Œæˆ–è€…æ— éœ€åˆå§‹åŒ–<code>UIFont</code>å®ä¾‹ä¾¿å¯è·å–å­—ä½“è§„æ ¼çš„ç»†èŠ‚ã€‚</font></p>

<p>Buildå¹¶è¿è¡Œappï¼›å‘ä¾¿ç¬ºä¸­è¾“å…¥æ–‡æœ¬ï¼Œå¹¶å°†å…¶ä¸­ä¸€ä¸ªè¯ç”¨æ˜Ÿå·ç¬¦åŒ…å›´ã€‚è¿™ä¸ªè¯å°†ä¼šè‡ªåŠ¨å˜ä¸ºé»‘ä½“ï¼Œå¦‚ä¸‹é¢æˆªå›¾æ‰€ç¤ºï¼š<br />
<img src="/images/BoldText.png" alt="image" /></p>

<p>##è¿›ä¸€æ­¥æ·»åŠ æ ·å¼
ä¸ºé™å®šæ–‡æœ¬æ·»åŠ é£æ ¼çš„åŸºæœ¬åŸåˆ™å¾ˆç®€å•ï¼š<strong>ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥å¯»æ‰¾å’Œæ›¿æ¢é™å®šå­—ç¬¦ï¼Œç„¶åç”¨applyStylesToRangeæ¥è®¾ç½®æƒ³è¦çš„æ–‡æœ¬æ ·å¼å³å¯ã€‚</strong><br />
åœ¨SyntaxHighlightTextStorage.mä¸­æ·»åŠ ä»¥ä¸‹å®ä¾‹å˜é‡ï¼š
{%codeblock lang:objc%}
- (void) createHighlightPatterns {
    UIFontDescriptor *scriptFontDescriptor =
      [UIFontDescriptor fontDescriptorWithFontAttributes:
          @{UIFontDescriptorFamilyAttribute: @&ldquo;Zapfino&rdquo;}];</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></pre></td>
<td class="lntd">
<pre class="chroma">// 1. base our script font on the preferred body font size
UIFontDescriptor* bodyFontDescriptor = [UIFontDescriptor
  preferredFontDescriptorWithTextStyle:UIFontTextStyleBody];
NSNumber* bodyFontSize = bodyFontDescriptor.
              fontAttributes[UIFontDescriptorSizeAttribute];
UIFont* scriptFont = [UIFont
          fontWithDescriptor:scriptFontDescriptor size:[bodyFontSize floatValue]];

// 2. create the attributes
NSDictionary* boldAttributes = [self
 createAttributesForFontStyle:UIFontTextStyleBody
                    withTrait:UIFontDescriptorTraitBold];
NSDictionary* italicAttributes = [self
 createAttributesForFontStyle:UIFontTextStyleBody
                    withTrait:UIFontDescriptorTraitItalic];
NSDictionary* strikeThroughAttributes = @{ NSStrikethroughStyleAttributeName : @1};
NSDictionary* scriptAttributes = @{ NSFontAttributeName : scriptFont};
NSDictionary* redTextAttributes =
                      @{ NSForegroundColorAttributeName : [UIColor redColor]};

// construct a dictionary of replacements based on regexes
_replacements = @{
          @&#34;(\*w+(sw+)\*\*)s&#34; : boldAttributes,
          @&#34;(_w+(sw+)\*_)s&#34; : italicAttributes,
          @&#34;([0-9]+.)s&#34; : boldAttributes,
          @&#34;(-w+(sw+)\*-)s&#34; : strikeThroughAttributes,
          @&#34;(~w+(sw+)\*~)s&#34; : scriptAttributes,
          @&#34;s([A-Z]{2,})s&#34; : redTextAttributes};</pre></td></tr></table>
</div>
</div>
<p>}
{%endcodeblock%}</p>

<p>è¿™ä¸ªæ–¹æ³•çš„ä½œç”¨ï¼š</p>

<ol>
<li>é¦–å…ˆï¼Œå®ƒä½¿ç”¨Zapfinoå­—ä½“æ¥åˆ›å»ºäº†â€œ<code>script</code>â€é£æ ¼ã€‚<strong>Font descriptors</strong>ä¼šå†³å®šå½“å‰æ­£æ–‡çš„é¦–é€‰å­—ä½“ï¼Œä»¥ä¿è¯<code>script</code>ä¸ä¼šå½±å“åˆ°ç”¨æˆ·çš„å­—ä½“å¤§å°è®¾ç½®ã€‚<br /></li>
<li>ç„¶åï¼Œå®ƒä¼šä¸ºæ¯ç§åŒ¹é…çš„å­—ä½“æ ·å¼æ„é€ å„ä¸ªå±æ€§ã€‚ä½ ç¨åå°†ç”¨åˆ° <strong><code>createAttributesForFontStyle:withTrait:</code></strong>ã€‚</li>
<li>æœ€åï¼Œå®ƒå°†åˆ›å»ºä¸€ä¸ª<code>NSDictionary</code>å¹¶å°†æ­£åˆ™è¡¨è¾¾å¼æ˜ å°„åˆ°ä¸Šé¢å£°æ˜çš„å±æ€§ä¸Šã€‚</li>
</ol>

<p>å¦‚æœä½ å¯¹æ­£åˆ™è¡¨è¾¾å¼ä¸æ˜¯éå¸¸ç†Ÿæ‚‰ï¼Œä¸Šé¢çš„çš„dictionaryå¯¹ä½ æ¥è¯´å¯èƒ½å¾ˆé™Œç”Ÿã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ ä¸€ç‚¹ä¸€ç‚¹ä»”ç»†åˆ†æå®ƒå…¶ä¸­åŒ…å«çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œå…¶å®ä¸ç”¨å¾ˆè´¹åŠ›å°±èƒ½ç†è§£äº†ã€‚</p>

<p>ä»¥ä¸Šé¢å®ç°çš„ç¬¬ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ä¸ºä¾‹ï¼Œå®ƒçš„å·¥ä½œæ˜¯åŒ¹é…æ˜Ÿå·ç¬¦åŒ…å›´çš„æ–‡æœ¬ï¼š<br />
(*w+(sw+)**)s<br />
ä¸Šé¢ä¸¤ä¸ªä¸¤ä¸ªç›¸è¿çš„æ–œæ ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯ç”¨æ¥å°†Objective-Cä¸­çš„ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰æˆå®ä½“å­—ç¬¦ã€‚å»æ‰ç”¨æ¥è½¬ä¹‰çš„æ–œæ ï¼Œæ¥çœ‹ä¸‹è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æ ¸å¿ƒéƒ¨åˆ†ï¼š<br />
(*w+(sw+)**)s<br />
ç°åœ¨ï¼Œé€æ­¥æ¥åˆ†æè¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼š<br />
{%codeblock lang:js%}
(*            â€”â€”  åŒ¹é…æ˜Ÿå·ç¬¦<br />
w+           â€”â€” åæ¥ä¸€ä¸ªæˆ–å¤šä¸ª â€œwordâ€å¼ å­—ç¬¦ä¸²<br />
(sw+)*     â€”â€” åæ¥é›¶ä¸ªæˆ–å¤šç»„ç©ºæ ¼ç„¶åå†æ¥ â€œwordâ€ å¼å­—ç¬¦ä¸²<br />
*)        â€”â€” åæ¥æ˜Ÿå·ç¬¦<br />
s         â€”â€” ä»¥ç©ºæ ¼ç»“å°¾<br />
{%endcodeblock%}
&gt; <font size=3>æ³¨ï¼šå¦‚æœä½ æƒ³å¯¹æ­£åˆ™è¡¨è¾¾å¼æœ‰æ›´å¤šäº†è§£ï¼Œè¯·å‚è€ƒ <a href="http://www.raywenderlich.com/30288/nsregularexpression-tutorial-and-cheat-sheet">NSRegularExpression tutorial and cheat sheet</a>.</font></p>

<p>ç°åœ¨ä½ éœ€è¦è°ƒç”¨<code>createHighlightPatternsï¼š</code>
å°†<strong>SyntaxHighlightTextStorage.m</strong> ä¸­çš„<code>init</code>æ–¹æ³•æ›´æ–°å¦‚ä¸‹ï¼š
{%codeblock lang:objc%}
- (id)init
{
    if (self = [super init]) {
        _backingStore = [NSMutableAttributedString new];
        [self createHighlightPatterns];
    }
    return self;
}
{%endcodeblock%}</p>

<p>åœ¨SyntaxHighlightTextStorage.mæ–¹æ³•ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š
{%codeblock lang:objc%}
- (NSDictionary<em>)createAttributesForFontStyle:(NSString</em>)style
                                    withTrait:(uint32_t)trait {
    UIFontDescriptor *fontDescriptor = [UIFontDescriptor
                               preferredFontDescriptorWithTextStyle:UIFontTextStyleBody];</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></pre></td>
<td class="lntd">
<pre class="chroma">UIFontDescriptor *descriptorWithTrait = [fontDescriptor
                                fontDescriptorWithSymbolicTraits:trait];

UIFont* font =  [UIFont fontWithDescriptor:descriptorWithTrait size: 0.0];
return @{ NSFontAttributeName : font };</pre></td></tr></table>
</div>
</div>
<p>}
{%endcodeblock%}</p>

<p>ä¸Šé¢çš„ä»£ç ä½œç”¨æ˜¯å°†æä¾›çš„å­—ä½“æ ·å¼ä½œç”¨åˆ°æ­£æ–‡å­—ä½“ä¸Šã€‚å®ƒç»™<code>fontWithDescriptor:size:</code> æä¾›çš„<code>size</code>å€¼ä¸º0ï¼Œè¿™æ ·åšä¼šè¿«ä½¿<code>UIFont</code>è¿”å›ç”¨æˆ·è®¾ç½®çš„å­—ä½“å¤§å°ã€‚</p>
    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">æ–‡ç« ä½œè€…</span>
    <span class="item-content">iTBoyer</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">ä¸Šæ¬¡æ›´æ–°</span>
    <span class="item-content">
        2019-08-08
        <a href="iEmacsd/commit/ccacacd56ce82e709b32bc57ad0c707301dbd1e0" title="è¿ç§»mdæ–‡æ¡£">(ccacacd)</a>
    </span>
  </p>
  
  
</div>
<div class="post-reward">
  <input type="checkbox" name="reward" id="reward" hidden />
  <label class="reward-button" for="reward">èµèµæ”¯æŒ</label>
  <div class="qr-code">
    
    <label class="qr-code-image" for="reward">
        <img class="image" src="/path/to/your/wechat-qr-code.png">
        <span>å¾®ä¿¡æ‰“èµ</span>
      </label>
    <label class="qr-code-image" for="reward">
        <img class="image" src="/path/to/your/alipay-qr-code.png">
        <span>æ”¯ä»˜å®æ‰“èµ</span>
      </label>
  </div>
</div><footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/textkit/">TextKit</a>
          <a href="/tags/%E6%A1%88%E4%BE%8B/">æ¡ˆä¾‹</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/ios/ui/storyboard%E4%B9%8Bsegue/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Storyboardä¹‹Segue</span>
            <span class="prev-text nav-mobile">ä¸Šä¸€ç¯‡</span>
          </a>
        <a class="next" href="/post/ios/iosdocumentinteraction%E7%BC%96%E7%A8%8B%E6%8C%87%E5%8D%97/">
            <span class="next-text nav-default">iOS Document Interaction ç¼–ç¨‹æŒ‡å—</span>
            <span class="next-text nav-mobile">ä¸‹ä¸€ç¯‡</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        <div id="comments-gitment"></div>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/theme-next/theme-next-gitment@1/default.min.css" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/gh/theme-next/theme-next-gitment@1/gitment.browser.min.js" crossorigin="anonymous"></script>
    <script type="text/javascript">
      var gitment = new Gitment({
        id: '2014-07-03 17:29:00 \x2b0800 CST',
        title: 'TextKitä¹‹ä¾¿ç¬ºå®æˆ˜',
        link: decodeURI(location.href),
        desc: '\x3ch2 id=\x22ä¾¿ç¬ºç»ƒä¹ åŠŸèƒ½ç‚¹\x22\x3eä¾¿ç¬ºç»ƒä¹ åŠŸèƒ½ç‚¹:\x3c\/h2\x3e\n\n\x3cp\x3eé€šè¿‡å®ç°ä»¥ä¸‹ç‰¹æ•ˆï¼Œç»ƒä¹ å¹¶æŒæ¡å¸ƒå±€ç®¡ç†å™¨ï¼ˆlayout mangerï¼‰ï¼Œæ–‡æœ¬å®¹å™¨ï¼ˆtext containersï¼‰å’Œæ–‡æœ¬å­˜å‚¨å™¨ï¼ˆtext storageï¼‰ç­‰ç”¨æ³•ã€‚\n  * åŠ¨æ€æ ·å¼ï¼ˆDynamic typeï¼‰\x3cbr \/\x3e\n  * å‡¸ç‰ˆå°åˆ·æ•ˆæœï¼ˆLetterpress effectsï¼‰\x3cbr \/\x3e\n  * ç¯ç»•è·¯å¾„ï¼ˆExclusion pathsï¼‰\x3cbr \/\x3e\n  * åŠ¨æ€æ–‡æœ¬æ ¼å¼åŠå­˜å‚¨ï¼ˆDynamic text formatting and storageï¼‰\x3c\/p\x3e\n\n\x3cp\x3eè¿™ä¸ªåº”ç”¨ä¸­æˆ‘ä»¬å°†å®ç°å›æµæ–‡æœ¬ï¼Œå­—ä½“å¤§å°çš„åŠ¨æ€å˜æ¢ï¼Œä»¥åŠé—ªå›æ–‡æœ¬ç­‰æ•ˆæœã€‚\næ•ˆæœå›¾:\x3cbr \/\x3e\n\x3cimg src=\x22\/images\/bianqian.png\x22 alt=\x22image\x22 \/\x3e\x3cbr \/\x3e\nAppå¼€å§‹è¿è¡Œåè‡ªåŠ¨ç”Ÿæˆä¸€ç»„ä¾¿ç¬ºå®ä¾‹å¹¶åˆ©ç”¨\x3ccode\x3etableViewController\x3c\/code\x3eæ˜¾ç¤ºå‡ºæ¥ã€‚\x3ccode\x3eStoryboards\x3c\/code\x3eå’Œ\x3ccode\x3esegues\x3c\/code\x3eä¼šå°†è¢«é€‰ä¸­çš„å•å…ƒæ ¼æ‰€å¯¹åº”çš„ä¾¿ç¬ºå†…å®¹æ˜¾ç¤ºå‡ºæ¥ä»¥ä¾›ç”¨æˆ·ç¼–è¾‘ã€‚\né¡¹ç›®å¼€å‘åŒ…ï¼š\x3ca href=\x22http:\/\/cdn4.raywenderlich.com\/wp-content\/uploads\/2013\/09\/TextKitNotepad-starter.zip\x22\x3eNotepad.zip\x3c\/a\x3e\x3c\/p\x3e\n\n\x3ch2 id=\x22åŠ¨æ€æ ·å¼\x22\x3eåŠ¨æ€æ ·å¼\x3c\/h2\x3e\n\n\x3cp\x3e\x3ccode\x3eåŠ¨æ€æ ·å¼ï¼ˆDynamic typeï¼‰\x3c\/code\x3eæ˜¯iOS 7é‡Œé¢å˜åŒ–æœ€å¤§çš„ç‰¹æ€§ä¹‹ä¸€; å®ƒä½¿å¾—appå¯ä»¥éµä»ç”¨æˆ·é€‰æ‹©çš„å­—ä½“å¤§å°å’Œç²—ç»†ã€‚\né€‰æ‹© \x3cstrong\x3eé€šç”¨-\x26gt;æ–‡å­—å¤§å°\x3c\/strong\x3e æˆ– \x3cstrong\x3eé€šç”¨-\x26gt;è¾…åŠ©åŠŸèƒ½\x3c\/strong\x3e æ¥æŸ¥çœ‹appä¸­çš„å­—ä½“è®¾ç½®ã€‚\x3c\/p\x3e\n\n\x3cp\x3e\x3cimg src=\x22\/images\/UserTextPreferences.png\x22 alt=\x22image\x22 \/\x3e\x3cbr \/\x3e\niOS 7 æ”¯æŒé€šè¿‡\x3ccode\x3eç²—ä½“\x3c\/code\x3eã€\x3ccode\x3eè®¾ç½®å­—ä½“å¤§å°\x3c\/code\x3eç­‰æ–¹å¼æé«˜æ”¯æŒåŠ¨æ€æ–‡æœ¬çš„åº”ç”¨çš„æ˜“è¯»æ€§ã€‚\nä¾‹å¦‚\x3cstrong\x3e\x3ccode\x3eUIFont\x3c\/code\x3e\x3c\/strong\x3eæ–°å¢çš„ä¸€ä¸ªæ–¹æ³•ï¼š \x3cstrong\x3e\x3ccode\x3epreferredFontForTextStyle\x3c\/code\x3e\x3c\/strong\x3e ç”¨æ¥æ ¹æ®ç”¨æˆ·å¯¹å­—ä½“å¤§å°çš„è®¾ç½®æ¥è‡ªåŠ¨åˆ¶å®šå­—ä½“æ ·å¼ã€‚\x3cbr \/\x3e\nä¸‹é¢è¡¨æ ¼ä¸­æ˜¯å…­ç§å¯ç”¨å­—ä½“æ ·å¼çš„ç¤ºä¾‹ï¼š\x3cbr \/\x3e\n\x3cimg src=\x22\/images\/TextStyles.png\x22 alt=\x22image\x22 \/\x3e\x3cbr \/\x3e\næœ€å·¦è¾¹ä¸€åˆ—æ˜¯æœ€å°å­—ä½“ï¼›ä¸­é—´ä¸€åˆ—æ˜¯æœ€å¤§å­—ä½“ï¼›æœ€å³è¾¹ä¸€åˆ—æ˜¯ç²—ä½“æ•ˆæœã€‚\x3c\/p\x3e\n\n\x3ch3 id=\x22ä½¿ç”¨ç³»ç»ŸåŠ¨æ€å­—ä½“æ ·å¼\x22\x3eä½¿ç”¨ç³»ç»ŸåŠ¨æ€å­—ä½“æ ·å¼\x3c\/h3\x3e\n\n\x3cp\x3eä½¿ç”¨åŠ¨æ€æ–‡æœ¬ï¼Œæ˜¯é€šè¿‡ç»™\x3ccode\x3eæ–‡æœ¬å­—ä½“\x3c\/code\x3eè®¾ç½®å­—ä½“æ ·å¼\x3cstrong\x3estyle\x3c\/strong\x3eè€Œä¸æ˜¯æŒ‡å®šå…·ä½“çš„\x3ccode\x3eå­—ä½“åç§°\x3c\/code\x3eå’Œ\x3ccode\x3eå¤§å°\x3c\/code\x3eã€‚è¿™æ ·ï¼Œç³»ç»Ÿä¼šåœ¨è¿è¡Œæ—¶è‡ªåŠ¨æ ¹æ®è¿™ä¸€æ ·å¼ä»¥åŠç”¨æˆ·çš„å­—ä½“å¤§å°è®¾ç½®æ¥é€‰æ‹©ä½¿ç”¨åˆé€‚çš„å­—ä½“ã€‚\x3c\/p\x3e\n\n\x3ch4 id=\x22preferredfontfortextstyle-æ–¹æ³•è®¾ç½®å­—ä½“æ ·å¼\x22\x3e\x3ccode\x3epreferredFontForTextStyle:\x3c\/code\x3eæ–¹æ³•è®¾ç½®å­—ä½“æ ·å¼\x3c\/h4\x3e\n\n\x3col\x3e\n\x3cli\x3eæ‰“å¼€ \x3ccode\x3eNoteEditorViewController.m\/swift\x3c\/code\x3e åœ¨\x3ccode\x3eviewDidLoadï¼š\x3c\/code\x3eæ–¹æ³•å®ç°çš„æœ€åé¢åŠ å…¥ä»¥ä¸‹ä»£ç ï¼š\n{%codeblock lang:objc%}\nself.textView.font = [UIFont preferredFontForTextStyle:UIFontTextStyleBody];\n{%endcodeblock%}\n{% codeblock  lang:swift %}\nself.textView.font = UIFont.preferredFont(forTextStyle: .body)\n{% endcodeblock %}\x3c\/li\x3e\n\x3cli\x3eæ‰“å¼€ \x3ccode\x3eNotesListViewController.m\/swift\x3c\/code\x3e åœ¨ \x3ccode\x3etableView:cellForRowAtIndexPath:\x3c\/code\x3e æ–¹æ³•ä¸­å¢åŠ å¦‚ä¸‹ä»£ç :\n{%codeblock lang:objc%}\ncell.textLabel.font = [UIFont preferredFontForTextStyle:UIFontTextStyleHeadline];\n{%endcodeblock%}\n{% codeblock  lang:swift %}\ncell.textLabel?.font = UIFont.preferredFont(forTextStyle: .headline)\n{% endcodeblock %}\nä¸Šé¢ä¸¤è¡Œä»£ç éƒ½ç”¨åˆ°äº†æ–°ç‰ˆiOSçš„å­—ä½“æ ·å¼.\x3cbr \/\x3e\n\x26gt; å­—ä½“æ ·å¼ï¼šé€šè¿‡è¯­ä¹‰æ³•å‘½åå­—ä½“ï¼Œä¾‹å¦‚ \x3ccode\x3eUIFontTextStyleSubHeadline\x3c\/code\x3e, å¯ä»¥é¿å…åœ¨ä»£ç é‡Œæ¯ä¸€å¤„éƒ½æŒ‡å®šå…·ä½“çš„å­—ä½“åç§°å’Œæ ·å¼ï¼Œ è€Œä¸”ç¡®ä¿appèƒ½å¯¹ç”¨æˆ·çš„å­—ä½“å¤§å°è®¾ç½®åšå‡ºæ°å½“çš„å›åº”ã€‚\x3c\/li\x3e\n\x3c\/ol\x3e\n\n\x3ch4 id=\x22appå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®\x22\x3eAPPå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®\x3c\/h4\x3e\n\n\x3col\x3e\n\x3cli\x3eè®¾ç½®ç³»ç»Ÿå­—ä½“\nè¿”å›åˆ°\x3cstrong\x3eé€šç”¨-\x26gt;æ–‡å­—å¤§å°\x3c\/strong\x3eé‡æ–°ä¿®æ”¹å­—ä½“è®¾ç½®.\nå†è¿è¡ŒApp, \x3cstrong\x3eNote\x3c\/strong\x3eé¡µé¢çš„æ–‡å­—å¤§å°æ˜¯å½“å‰è®¾å®šçš„å­—ä½“å¤§å°ï¼›å‰åæˆªå±å¯¹æ¯”,åˆ†è¾¨ç‡å°äº†ä¸€åŠã€‚\x3cbr \/\x3e\n\x3cimg src=\x22\/images\/NotepadWithDynamicType.png\x22 alt=\x22image\x22 \/\x3e\x3c\/li\x3e\n\x3cli\x3eè®¾ç½®ç³»ç»Ÿå­—ä½“ç”Ÿæ•ˆ\nå½“æˆ‘ä»¬è¿”å›åˆ°\x3cstrong\x3eé€šç”¨-\x26gt;æ–‡å­—å¤§å°\x3c\/strong\x3eé‡æ–°ä¿®æ”¹å­—ä½“è®¾ç½®. å†æ‰“å¼€\x3cstrong\x3eNote\x3c\/strong\x3eé¡µé¢, ä¼šå‘ç°appå¹¶æ²¡æœ‰\x3cstrong\x3eç«‹å³\x3c\/strong\x3eå¯¹å­—ä½“è®¾ç½®çš„å˜åŒ–åšå‡ºç›¸åº”ååº”ã€‚\x3c\/li\x3e\n\x3c\/ol\x3e\n\n\x3ch5 id=\x22ç›‘å¬ç³»ç»Ÿé€šçŸ¥-å®ç°appå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®\x22\x3eç›‘å¬ç³»ç»Ÿé€šçŸ¥ï¼šå®ç°APPå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®\x3c\/h5\x3e\n\n\x3cp\x3eå½“ç”¨æˆ·ä¿®æ”¹äº†ä»–ä»¬çš„å­—ä½“å¤§å°è®¾ç½®ä¹‹åï¼Œè¿™ä¸€æ ·å¼å¯¹åº”çš„å­—ä½“å¹¶ä¸ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œå¿…é¡»é‡æ–°è¯·æ±‚æ‰èƒ½è·å–æ–°çš„å€¼ã€‚ç”¨æˆ·è®¾ç½®å˜åŒ–åï¼Œ\x3ccode\x3epreferredFontForTextStyle:\x3c\/code\x3eæ–¹æ³•è¿”å›çš„å­—ä½“ä¹Ÿä¼šå˜åŒ–ã€‚\n1. æ·»åŠ ç›‘å¬ç³»ç»Ÿé€šçŸ¥\x3ccode\x3eUIContentSizeCategoryDidChangeNotification\x3c\/code\x3eé€šçŸ¥APPå“åº”ç”¨æˆ·å­—ä½“è®¾ç½®çš„å˜åŒ–\næ‰“å¼€ \x3ccode\x3eNoteEditorViewController.m\x3c\/code\x3e å¹¶åœ¨ \x3ccode\x3eviewDidLoad\x3c\/code\x3e æ–¹æ³•çš„å®ç°çš„æœ€ååŠ å…¥ä»¥ä¸‹ä»£ç ï¼š\n{%codeblock lang:objc%}\n[[NSNotificationCenter defaultCenter]\n                              addObserver:self\n                                 selector:@selector(preferredContentSizeChanged:)\n                                     name:UIContentSizeCategoryDidChangeNotification\n                                   object:nil];\n{%endcodeblock%}\n{%codeblock lang:swift%}\n\/\/å­—ä½“å˜åŒ–é€šçŸ¥:è°ƒç”¨preferredContentSizeChanged:æ–¹æ³•\nNotificationCenter.default.addObserver(self, selector: #selector(NoteEditorViewController.preferredContentSizeChanged(\x3cem\x3e:)), name: NSNotification.Name.UIContentSizeCategoryDidChange, object: nil)\n{%endcodeblock%}\n2. æ·»åŠ ç³»ç»Ÿé€šçŸ¥å“åº”äº‹ä»¶\næ”¶åˆ°ç”¨äºæŒ‡å®šæœ¬ç±»æ¥æ”¶å­—ä½“è®¾å®šå˜åŒ–çš„é€šçŸ¥åï¼Œè°ƒç”¨\x3ccode\x3epreferredContentSizeChanged:\x3c\/code\x3eæ–¹æ³•\nåœ¨\x3ccode\x3eNoteEditorViewController.m\x3c\/code\x3eä¸­\x3ccode\x3eviewDidLoad\x3c\/code\x3eæ–¹æ³•ä¹‹åç´§æ¥ç€æ·»åŠ ä»¥ä¸‹æ–¹æ³•ï¼š\n{%codeblock lang:objc%}\n- (void)preferredContentSizeChanged:(NSNotification *)notification\n{\n    self.textView.font = [UIFont preferredFontForTextStyle:UIFontTextStyleBody];\n}\n{%endcodeblock%}\n{%codeblock lang:swift %}\n\/\/å­—ä½“å˜åŒ–é€šçŸ¥æ—¶è°ƒç”¨\nfunc preferredContentSizeChanged(\x3c\/em\x3e notification:NSNotification)\n{\n    self.textView.font = UIFont.preferredFont(forTextStyle: .body)\n}\n{%endcodeblock%}\nè¿™ä¸€æ–¹æ³•ä½œç”¨æ˜¯æ ¹æ®æ–°çš„å­—ä½“è®¾ç½®æ¥è®¾å®š\x3ccode\x3etextView\x3c\/code\x3eä¸­çš„å­—ä½“ã€‚\x3cbr \/\x3e\nBuildå¹¶è¿è¡Œappï¼Œä¿®æ”¹å­—ä½“å¤§å°è®¾ç½®ï¼ŒNoteé¡µé¢å°±å¯ä»¥å³æ—¶æ›´æ–°å­—ä½“å¤§å°äº†ã€‚\x3c\/p\x3e',
        owner: 'huos3203',
        repo: 'huos3203.github.io',
        oauth: {
          client_id: 'd46ea301857e36a08319',
          client_secret: '9da00f1f475c4166b96fbe157d0afdbd64cc613c'
        }
      });
      gitment.render('comments-gitment');
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/imsun/gitment">comments powered by gitment.</a></noscript>
  
  

  
    <script src="https://utteranc.es/client.js"
            repo="huos3203/huos3203.github.io"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/utterance">comments powered by utterances.</a></noscript>

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:iTBoyer@qq.com" class="iconfont icon-email" title="email"></a>
      <a href="https://github.com/huos3203" class="iconfont icon-github" title="github"></a>
      <a href="http://weibo.com/1791281385" class="iconfont icon-weibo" title="weibo"></a>
      <a href="http://www.zhihu.com/people/boyers" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="http://douban.com/people/boyers" class="iconfont icon-douban" title="douban"></a>
      <a href="http://localhost:1313" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="https://huos3203.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    ç”± <a class="hexo-link" href="https://gohugo.io">Hugo</a> å¼ºåŠ›é©±åŠ¨
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    ä¸»é¢˜ - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv"> æœ¬ç«™æ€»è®¿é—®é‡ <span id="busuanzi_value_site_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> æ¬¡ </span>
      <span class="division">|</span>
    <span id="busuanzi_container_site_uv"> æœ¬ç«™æ€»è®¿å®¢æ•° <span id="busuanzi_value_site_uv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> äºº </span>
  </div>

  <span class="copyright-year">
    &copy; 
    2017 - 
    2019
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">iTBoyer</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script src="/lib/highlight/highlight.pack.js?v=20171001"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
<script type="text/javascript" src="/dist/even.26188efa.min.js"></script>








</body>
</html>
